[
  {
    "children": [
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('AWS Connect');\nrequest.setSessionAttribute('contact.phone', '+15552222345');\nrequest.setSessionAttribute('contact.okToCall', true);\nrequest.setSessionAttribute('contact.address', {\n    street: '1234 Main St'\n    city: 'API City',\n    zip: 91335\n});</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "origin",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "Optional. Origin of the request. Usually the name of the computer telephony\n                integrator provider. <p class=\"p\">Default: null</p>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-CTIOperationRequest_S",
        "hasExample": true,
        "hasParameter": true,
        "name": "CTIOperationRequest(String origin)",
        "order": 1840,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Instantiates a CTIOperationRequest object.",
        "text2": null,
        "type": "Constructor",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*CTIProviderResponseExecutionContext*/ ctx, /*CTIOperationRequest*/ operationRequest, /*CTIOperationResponse*/ operationResponse, /*HTTPResponse*/ httpResponse) {\n  var sessionAttributes = {},\n      intentResponse;\n  var statusCode = -1;\n  var message = 'Unprocessed';\n  if (operationResponse) {\n    statusCode = operationResponse.getStatusCode();\n    sessionAttributes = operationResponse.getSessionAttributes();\n    message = operationResponse.getMessage();\n    var error = operationResponse.getError();\n    if (error) {\n      sessionAttributes.error = error;\n    }\n  }\n  if (sn_cti_core.CTIRequestDispatcher.Constants.HTTP.Status.AUTH_REQUIRED.code === statusCode) {\n    //first call for a secure action without authentication token\n    sessionAttributes.statusCode = 401;\n    sessionAttributes.message = message;\n    intentResponse = {\n      sessionAttributes: sessionAttributes,\n      dialogAction: {\n        type: 'Close',\n        fulfillmentState: 'Fulfilled',\n        message: {\n          contentType: 'PlainText',\n          content: 'This operation requires authentication. Say authenticate for authentication.'\n        }\n      }\n    };\n  } else if ('DialogCodeHook' === operationRequest.getParameter('$$invocationSource')) {\n      //pass back authToken and interactionId\n      sessionAttributes.authToken = operationRequest.getAuthToken();\n      sessionAttributes.interactionId = operationRequest.getInteractionSysId();\n      var originalSlots = operationRequest.getParameter('$$slots');\n      var responseParameters = operationResponse ? operationResponse.getParameters() : {};\n      responseParameters = responseParameters ? responseParameters : {};\n      // See if processing happened and we got a dialogAction\n      var responseDialogAction = responseParameters['dialogAction'];\n      // Default dialog action\n      var dialogAction = {\n        type: 'Delegate',\n        slots: originalSlots\n      };\n      // If the response doesn't contain an override replay the inputs\n      if (responseDialogAction) {\n        // We bypassed dialoghook so delegate and pass through inputs\n        dialogAction = responseDialogAction;\n      }\n      intentResponse = {\n        sessionAttributes: sessionAttributes,\n        dialogAction: dialogAction\n      };\n  } else {\n    // Override required session attributes\n    sessionAttributes.statusCode = statusCode;\n    sessionAttributes.message = message;\n    // Build response template\n    intentResponse = {\n      sessionAttributes: sessionAttributes,\n      dialogAction: {\n        type: 'Close',\n        fulfillmentState: 'Fulfilled',\n        message: {\n          contentType: 'PlainText',\n          content: message\n        }\n      }\n    };\n  }\n  httpResponse.setBody(intentResponse);\n})(ctx, operationRequest, operationResponse, httpResponse);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The authentication token associated with the current Cloud Call Center user.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getAuthToken",
        "hasExample": true,
        "hasReturn": true,
        "name": "getAuthToken()",
        "order": 5730,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the authentication token set on the associated CTIOperationRequest\n    object.",
        "text2": "<p>This token is used by the Cloud Call Center framework to authenticate the current Cloud\n        Call Center user before executing the requested operation handler if the handler's\n          <span class=\"keyword parmname\">auth_required</span> flag is set to true. The\n          <span class=\"keyword parmname\">auth_required</span> flag is a field in the Operation Handler\n        [sn_cti_operation_handler] table. The life of an authentication token should be for the life\n        of the call session, but is determined by the CTI provider.</p><p>You can define whatever authentication/authorization handling required by your\n        implementation by creating your own authentication operation handler. Regardless of how the\n        authentication token is generated, the message translator must pass the token back in the\n        CTI payload. Additionally, the CTI provider must store this authentication token locally and\n        pass it in each operation request that requires authentication.</p><p>If using the instance provided authenticate operation handler, the handler initiates the\n        creation of the authentication token based on a four-digit user-entered pin. It then sets\n        the authentication token in the sessionAttributes object of the CTIOperationResponse object.\n        The associated message transformer translates the sessionAttributes object into the\n        CTI-specific payload and then sends it to the CTI provider.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> If the authentication token is not passed, all requests to execute operation handlers\n          with the <span class=\"keyword parmname\">auth_required</span> flag set will fail. If you do not use\n          authentication, you do not need to maintain authentication tokens.</div></p><p>The <span class=\"ph\">ServiceNow</span> base system provides\n        working operation handlers and message transformers that enable connection to Amazon\n        Connect. When building contact flows within Amazon Connect, there are two integration points\n        between Amazon services and a <span class=\"ph\">ServiceNow</span> instance:<ul class=\"ul\" id=\"CTIOpReq-getAuthToken__d668e90\">\n          <li class=\"li\">Amazon Web Services (AWS) Lambda Proxy (Invoke AWS Lambda function)</li>\n\n          <li class=\"li\">AWS Lex Bot (Get Customer Input) </li>\n\n        </ul>\nYou can find the available operation handlers and message transformers for these\n        integration points in the Operation Handlers [sn_cti_operation_handler] and Provider Message\n        Transformer [sn_cti_provider_msg_transormer] tables.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "GlideRecord",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Interaction GlideRecord object associated with the current CTIOperationRequest\n                object. If the interaction record sys_id has not been set on the CTIOperationRequest\n                object, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function(/*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response, /*Context*/ ctx) {\t\n  var notes = '', lang = request.getLanguage();\n  try { \n    // Returns the interaction record (GlideRecord) set on the passed in CTIOperationRequest object\t\t\n    var interactionGr = request.getInteractionRecord();\n\n    var now_GR = new GlideRecord('sys_user');\n    if(interactionGr &amp;&amp; now_GR.get(interactionGr.opened_for.toString())) {\t\n      if(now_GR.locked_out == true) {\n        notes += gs.getMessageLang(\"User record found locked. Unlocking the account.\\n\", lang);\n        now_GR.locked_out=false;\n        now_GR.update();\n        response.setStatusCode(200);\n        response.setMessage(gs.getMessageLang(\"Your account has been unlocked.\", lang));\n      } else {\n        notes += gs.getMessageLang(\"User record not locked.\\n\", lang);\n        response.setStatusCode(200);\n        response.setMessage(gs.getMessageLang(\"Your account doesn't seem to be locked.\", lang));\n      }\t\n    } else {\n      notes += gs.getMessageLang(\"User record not found. Transfer to agent\\n\", lang);\n      response.setStatusCode(302);\n      response.setMessage(gs.getMessageLang(\"I am unable to find your record. Let me transfer to someone who can help.\", lang));\n    }\n    if(interactionGr) {\n      interactionGr.work_notes = notes;\n      interactionGr.update();\n    }\n  } catch(e) {\n    ctx.setError(e);\n  }\n})(request, response, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getInteractionRecord",
        "hasExample": true,
        "hasReturn": true,
        "name": "getInteractionRecord()",
        "order": 7760,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the interaction GlideRecord associated with the operation request.",
        "text2": "<p>An interaction represents a customer request for assistance made through a chat, phone\n        call, or in-person. Interactions can be routed to queues for assignment or assigned to\n        agents directly. Interaction records are stored in the Interaction [interaction] table and\n        can contain any type of data that describes service account interactions with a customer for\n        a specific session.</p><p>Interaction records are associated with a CTIOperationRequest object through the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setInteractionSysId_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setInteractionSysId(String Id)</a>\n        method. This method is typically called by the message transformer and must be called prior\n        to calling the <span class=\"keyword apiname\">getInteractionRecord()</span> method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response, ctx) {\n  // Returns the sys_id of the interaction record associated with the CTIOperationRequest object.\n  var interactionSysId = request.getInteractionSysId();\n  var number = request.getParameter('number');\n  var addComment = request.getParameter('add_comment');\n  addComment = addComment ? addComment.toLowerCase() : addComment;\n  addComment = 'yes' === addComment || 'true' === addComment || '1' === addComment;\n  var workNotes = request.getParameter('work_notes');\n  var message = gs.getMessage('Thankyou');\n  var interactionGr = request.getInteractionRecord();\n  var openedFor = interactionGr ? interactionGr.getValue('opened_for') : null;\n  if (openedFor &amp;&amp; number &amp;&amp; addComment &amp;&amp; workNotes) {\n    var now_GR = new GlideRecordSecure('incident');\n    now_GR.addQuery('caller_id', openedFor);\n    now_GR.addQuery('number', number);\n    now_GR.query();\n    if (now_GR.next()) {\n      now_GR.work_notes += workNotes;\n      now_GR.update();\n      message = gs.getMessage('Your comment was added');\n    }\n  }\n  response.setStatusCode(200);\n  response.setMessage(message);\n})(request, response, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The sys_id of the interaction record set on the current CTIOperationRequest\n                  object.<p class=\"p\">If the sys_id was not set on the associated CTIOperationRequest object,\n                  the method returns null.</p>",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getInteractionSysId",
        "hasExample": true,
        "hasReturn": true,
        "name": "getInteractionSysId()",
        "order": 7770,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the sys_id of the interaction record associated with the current\n    CTIOperationRequest object.",
        "text2": "<p>The <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setInteractionSysId_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setInteractionSysId(String Id)</a>\n        method must have been called prior to calling this method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The ISO 639.1 language code set on the current CTIOperationRequest object. If\n                the language code is not set, returns <samp class=\"ph systemoutput\">en</samp>.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function(/*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response) {\n  // Obtain the contact's preferred language\n  var notes = \"\", announcement, lang = request.getLanguage();\n  try {\n\t\t\n    var interactionGr = request.getInteractionRecord();\n\t\t\n    announcement = gs.getMessageLang(\"We are currently experiencing issues with VPN. If you are calling about VPN issues, you may hang up the call.\", lang);\n    // Use the contact's language to customize the response messages and notes\t\n    if(announcement) {\t\n      notes = gs.getMessageLang(\"Listened to announcement: {0}\", lang, [announcement]);\n      response.setStatusCode(200);\n    } else {\n      announcement = gs.getMessageLang(\"There are currently no known outage announcements\", lang);\n      //use the status case as the flag to check for announcements in contact flow\n      response.setStatusCode(404);\n    }\t\t\t\n    response.setMessage(announcement);\t\n\t\t\t\n    if(interactionGr &amp;&amp; notes) {\t\t\t\n      interactionGr.work_notes = notes;\t\t\n      interactionGr.update();\n    }\n\t\t\n  } catch(e) {\n    ctx.setError(e);\n  }\n\n})(request, response);</code>",
            "text2": "The following  shows an operation handler calling <span class=\"keyword apiname\">getLanguage()</span>\n        to obtain the caller's preferred language.",
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getLanguage",
        "hasExample": true,
        "hasReturn": true,
        "name": "getLanguage()",
        "order": 7980,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the ISO 639.1 language code that was set on the current CTIOperationRequest\n    object.",
        "text2": "<p>Using the customer preferred language enables you to use platform-provided\n        internationalization and localization capabilities to customize messages and other\n        communications with the associated caller.</p><p>Typically an operation handler calls the getLanguage() method and the message transformer\n        sets the language on the CTIOperationRequest object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setLanguage_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setLanguage(String languageCode)</a> method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Major version number of the CTI software.<p class=\"p\">If the major version was never set,\n                  returns <samp class=\"ph systemoutput\">1</samp>. </p>",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar majorVersion = request.getMajorVersion();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getMajorVersion",
        "hasExample": true,
        "hasReturn": true,
        "name": "getMajorVersion()",
        "order": 8100,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the major version of the computer telephony integrator (CTI) software set on\n    the current CTIOperationRequest object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span> instance are running multiple versions of their software, as\n        different software versions may require different processing behavior. If the processing\n        behavior is only slightly different between the software versions, it may make sense to have\n        only a single operation handler. You can then handle the processing differences by just\n        checking the version of software making the request and process the request/data within your\n        operation handler. If the required processing is significantly different between versions,\n        it may be more effective to use multiple operation handlers.</p><p>Typically the message transformer sets the software version on the CTIOperationRequest\n        object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setMajorVersion_N&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setMajorVersion(Number majorVersion)</a>\n        method and an operation handler then consumes the set value using this method. You can also\n        get/set the minor version value of a provider's software using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getMinorVersion&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getMinorVersion()</a> and <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setMinorVersion_N&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setMinorVersion(Number minorVersion)</a>\n        methods.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar minorVersion = request.getMinorVersion();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Minor version number of the CTI software. <p class=\"p\">If the minor version was never\n                  set, returns <samp class=\"ph systemoutput\">0</samp>. </p>",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getMinorVersion",
        "hasExample": true,
        "hasReturn": true,
        "name": "getMinorVersion()",
        "order": 8210,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the minor version of the computer telephony integrator (CTI) software\n    associated with a CTIOperationRequest object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span> instance are running multiple versions of their software, as\n        different software versions may require different processing behavior. If the processing\n        behavior is only slightly different between the software versions, it may make sense to have\n        only a single operation handler. You can then handle the processing differences by just\n        checking the version of software making the request and process the request/data within your\n        operation handler. If the required processing is significantly different between versions,\n        it may be more effective to use multiple operation handlers.</p><p>Typically the message transformer sets the software version on the CTIOperationRequest\n        object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setMinorVersion_N&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setMinorVersion(Number minorVersion)</a><a class=\"xref\" href=\"dev.do#!/reference/api/paris/server/sn_cti_core-namespace/CTIOperationRequestAPI#CTIOpReq-setMinorVersion_N\" title=\"Sets the minor version of the computer telephony integrator (CTI) provider software making the request on the associated CTIOperationRequest object.\">CTIOperationRequest - setMinorVersion(Number minorVersion)</a>\n        method and an operation handler then consumes the set value using this method. You can also\n        get/set the major version value of a provider's software using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getMajorVersion&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getMajorVersion()</a><a class=\"xref\" href=\"dev.do#!/reference/api/paris/server/sn_cti_core-namespace/CTIOperationRequestAPI#CTIOpReq-getMajorVersion\" title=\"Returns the major version of the computer telephony integrator (CTI) software set on the current CTIOperationRequest object.\">CTIOperationRequest - getMajorVersion()</a> and <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setMajorVersion_N&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setMajorVersion(Number majorVersion)</a><a class=\"xref\" href=\"dev.do#!/reference/api/paris/server/sn_cti_core-namespace/CTIOperationRequestAPI#CTIOpReq-setMajorVersion_N\" title=\"Sets the major version of the computer telephony integrator (CTI) provider software making the request on the associated CTIOperationRequest object.\">CTIOperationRequest - setMajorVersion(Number majorVersion)</a>\n        methods.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The name of the operation that the CTI provider is requesting to execute. If\n                the operation name is not set, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar name = request.getOperationName();\n</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getOperationName",
        "hasExample": true,
        "hasReturn": true,
        "name": "getOperationName()",
        "order": 8440,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the name of the operation that the computer telephony integration (CTI)\n    provider is requesting to execute.",
        "text2": "<p>The operation name determines the operation handler that is used to process a request.\n        Typically the message transformer sets the operation name on the CTIOperationRequest object\n        using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setOperationName_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setOperationName(String name)</a>\n        method.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> The <span class=\"keyword apiname\">getOperationName()</span> method does not instantiate the associated\n          operation handler. This is done by the Cloud Call Center framework. This method simply\n          returns the associated operation handler name.</div>\n\n        <div class=\"note note\"><span class=\"notetitle\">Note:</span> For Amazon Connect Lex\n          Bot implementations, intent names are appended with a five letter suffix as different\n          Amazon intents cannot have the same intent name. In the Cloud Call Center framework, the\n          intent name equals the operation handler name. An operation handler can either be specific\n          for an intent, having an operation handler name that includes this suffix\n          (myOperation_SUFFX), or it can be generic and used by multiple CTI providers or different\n          use cases, such as using the same handler for processing an HR request and a helpdesk\n          request (myOperation).</div></p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The name of the substep operation handler set on the CTIOperationRequest\n                object. If it does not exist, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar name = request.getOperationSubStepName();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getOperationSubStepName",
        "hasExample": true,
        "hasReturn": true,
        "name": "getOperationSubStepName()",
        "order": 8450,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the substep operation handler name set on the current CTIOperationRequest\n    object.",
        "text2": "<p>Use substeps to perform actions such as initialization and validation before processing an\n        operation. Unlike operation handlers that are meant to be generic and used by all CTI\n        providers, substeps are CTI provider specific and use terminology and naming conventions\n        that are specific to the CTI provider.</p><p>The Cloud Call Center framework performs the following steps to locate the required\n        operation handler and any associated substep operation handlers.<div class=\"note note\" id=\"CTIOpReq-getOperationSubStepName__d668e108\"><span class=\"notetitle\">Note:</span> For Amazon Connect Lex\n          Bot implementations, intent names are appended with a five letter suffix as different\n          Amazon intents cannot have the same intent name. In the Cloud Call Center framework, the\n          intent name equals the operation handler name. An operation handler can either be specific\n          for an intent, having an operation handler name that includes this suffix\n          (myOperation_SUFFX), or it can be generic and used by multiple CTI providers or different\n          use cases, such as using the same handler for processing an HR request and a helpdesk\n          request (myOperation).</div>\n<ol class=\"ol\" id=\"CTIOpReq-getOperationSubStepName__d668e110\">\n          <li class=\"li\">Tries to locate the operation handler associated with the request. <ul class=\"ul\" id=\"CTIOpReq-getOperationSubStepName__d668e114\">\n              <li class=\"li\">First checks for an operation handler called <code class=\"ph codeph\">myOperation_SUFFX</code>. </li>\n\n              <li class=\"li\">If not found, checks for the operation handler <code class=\"ph codeph\">myOperation</code>. If\n                not found, errors out.</li>\n\n            </ul>\n</li>\n\n          <li class=\"li\">If the handler is found, checks the <span class=\"keyword parmname\">auth_required</span> flag on the\n            operation handler. If set, it checks that a valid authentication token (obtained through\n            the <span class=\"keyword apiname\">getAuthToken()</span> method) is present on the request. If present and\n            valid, continue processing, else throw an error.</li>\n\n          <li class=\"li\">Looks up the operation handler for the passed in substep. For this example let's\n            assume <code class=\"ph codeph\">subStepName=SubStep</code>.<ul class=\"ul\" id=\"CTIOpReq-getOperationSubStepName__d668e143\">\n              <li class=\"li\">First checks for an operation handler named\n                  <code class=\"ph codeph\">myOperation_SUFFX.SubStep</code>. If found, executes the handler.</li>\n\n              <li class=\"li\">If not found, checks for the handler <code class=\"ph codeph\">myOperation.SubStep</code>. If\n                found executes the handler.</li>\n\n              <li class=\"li\">If not found, checks if a <code class=\"ph codeph\">subStepNotFoundBehavior</code> was set on the\n                request object.</li>\n\n              <li class=\"li\">If set, executes the behavior, otherwise, errors out.</li>\n\n            </ul>\n</li>\n\n          <li class=\"li\">Executes the primary operation handler (<code class=\"ph codeph\">myOpersation_SUFFX</code> or\n              <code class=\"ph codeph\">myOperation</code>.)</li>\n\n        </ol></p><p>Typically the message transformer sets the substep name on the CTIOperationRequest object\n        using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setOperationSubStepName_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setOperationSubStepName(String name)</a> method. You can override this behavior if\n        you are creating your own transformer by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setSubStepNotFoundBehav_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setSubStepNotFoundBehaviour(Object behaviour)</a> method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response, ctx) {\n  var interactionSysId = request.getInteractionSysId();\n  // Returns the number and add_comment parameters from the CTIOperationRequest object\n  var number = request.getParameter('number');\n  var addComment = request.getParameter('add_comment');\n  addComment = addComment ? addComment.toLowerCase() : addComment;\n  addComment = 'yes' === addComment || 'true' === addComment || '1' === addComment;\n  var workNotes = request.getParameter('work_notes');\n  var message = gs.getMessage('Thankyou');\n  var interactionGr = request.getInteractionRecord();\n  var openedFor = interactionGr ? interactionGr.getValue('opened_for') : null;\n  if (openedFor &amp;&amp; number &amp;&amp; addComment &amp;&amp; workNotes) {\n    var now_GR = new GlideRecordSecure('incident');\n    now_GR.addQuery('caller_id', openedFor);\n    now_GR.addQuery('number', number);\n    now_GR.query();\n    if (now_GR.next()) {\n      now_GR.work_notes += workNotes;\n      now_GR.update();\n      message = gs.getMessage('Your comment was added');\n    }\n  }\n  response.setStatusCode(200);\n  response.setMessage(message);\n})(request, response, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String or Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Value of the specified key. If no such key exists, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The name of the key value to return.",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getParameter_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "getParameter(String key)",
        "order": 8540,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the value of a specified key previously set on the current CTIOperationRequest\n    object.",
        "text2": "<p>Using the get/set parameter methods enables the passing of\n        virtually any string or number value between a message transformer and an operation handler.\n        The parameter object can contain zero or more key/value pairs of data that directly\n        correlate to the current operation request. The operation handler determines what key/value\n        pairs are required as it consumes these values. Typically the message transformer sets these\n        parameters on the CTIOperationRequest object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setParameter_S_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setParameter(String key, Object value)</a> method and the operation handler\n        consumes them using this method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar parms = request.getParameters();\nfor(var key in parms) {\n    gs.info(key + '=' + parms[key]);\n}</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Object",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "A map of key-value pairs that were previously set on the CTIOperationRequest\n                object. This key-value pairs are free-form and defined by the needs of the operation\n                handler. The returned values are either Strings or Numbers.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getParameters",
        "hasExample": true,
        "hasReturn": true,
        "name": "getParameters()",
        "order": 8600,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the key-value pairs for all parameters that were previously set on the current\n    CTIOperationRequest object.",
        "text2": "<p>Using the get/set parameter methods enables the passing of\n        virtually any string or number value between a message transformer and an operation handler.\n        The parameter object can contain zero or more key/value pairs of data that directly\n        correlate to the current operation request. The operation handler determines what key/value\n        pairs are required as it consumes these values. Typically the message transformer sets these\n        parameters on the CTIOperationRequest object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setParameter_S_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setParameter(String key, Object value)</a> method and the operation handler\n        consumes them using this method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "String or Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Value of the specified key. If no such key exists, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The name of the key value to return.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar phoneAttribute = request.getSessionAttribute('contact.phone');</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getSessionAttribute_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "getSessionAttribute(String key)",
        "order": 9320,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the value of a specified session attribute key set on the current\n    CTIOperationRequest object.",
        "text2": "<p>Using the get/set session attribute methods enables the\n        passing of virtually any string or number value between a message transformer and an\n        operation handler. The sessionAttribute object can contain zero or more key/value pairs of\n        data that are valid for the duration of a computer telephony integration provider defined\n        session, such as the contact's phone number. Session attributes can also be accessed within\n        a contact flow. The operation handler determines what session attribute key/value pairs are\n        needed as it consumes these values. Typically the message transformer sets these attributes\n        on the CTIOperationRequest object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setSessionAttribute_S_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setSessionAttribute(String key, Object value)</a>\n        method. Session attributes are different than parameters in that they persist for the life\n        of the session (such as the entire call) and should be passed back by the CTI provider with\n        each operation request within that call session.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar parms = request.getSessionAttributes();\nfor(var key in parms) {\n    gs.info(key + '=' + parms[key]);\n}</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Object",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "A map of session attribute key-value pairs that were set on the associated\n                CTIOperationResponse object. This map is free-form and defined by the needs of the\n                operation handler.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getSessionAttributes",
        "hasExample": true,
        "hasReturn": true,
        "name": "getSessionAttributes()",
        "order": 9340,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns a key-value pair map of all session attributes set on the current\n    CTIOperationRequest object.",
        "text2": "<p>Using the get/set session attribute methods enables the\n        passing of virtually any string or number value between a message transformer and an\n        operation handler. The sessionAttribute object can contain zero or more key/value pairs of\n        data that are valid for the duration of a computer telephony integration provider defined\n        session, such as the contact's phone number. Session attributes can also be accessed within\n        a contact flow. The operation handler determines what session attribute key/value pairs are\n        needed as it consumes these values. Typically the message transformer sets these attributes\n        on the CTIOperationRequest object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setSessionAttribute_S_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setSessionAttribute(String key, Object value)</a>\n        method. Session attributes are different than parameters in that they persist for the life\n        of the session (such as the entire call) and should be passed back by the CTI provider with\n        each operation request within that call session.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nvar behavior = request.getSubStepNotFoundBehaviour();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "OperationNotFoundBehaviours",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The behavior/handling to perform when an operation handler cannot be found for\n                the operation/substep combination\n                (<span class=\"keyword parmname\">&lt;operation_name&gt;</span>.SubStep>). If not defined, returns\n                  null.<div class=\"p\">Possible values:<ul class=\"ul\" id=\"CTIOpReq-getSubStepNotFoundBehaviour__ul_kbc_53f_1lb\">\n                    <li class=\"li\">OperationNotFoundBehaviours.ThrowError: Throw an error.</li>\n\n                    <li class=\"li\">OperationNotFoundBehaviours.PassThrough: Do not perform any further\n                      processing on the request, just return.</li>\n\n                    <li class=\"li\">OperationNotFoundBehaviours.RouteToOperation: Use the parent operation\n                      handler <span class=\"keyword parmname\">&lt;operation_name&gt;</span>.</li>\n\n                  </ul>\n</div>",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-getSubStepNotFoundBehaviour",
        "hasExample": true,
        "hasReturn": true,
        "name": "getSubStepNotFoundBehaviour",
        "order": 9600,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the handling behavior for a subsep when a substep's operation handler is not\n    found.",
        "text2": "<p>Use substeps to perform actions such as initialization and validation before processing an\n        operation. Unlike operation handlers that are meant to be generic and used by all CTI\n        providers, substeps are CTI provider specific and use terminology and naming conventions\n        that are specific to the CTI provider.</p><p>If the requested substep operation handler cannot be found by the Cloud Call Center\n        framework, it attempts to use the \"step not found behavior\". This behavior is typically set\n        by the message transformer when an operation is initially requested.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "id",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The authentication token for the associated Cloud Call Center user.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>{\t\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n\tvar event = jsonPayload.event;\n\tif (event) {\n\t  var details = event.Details;\n\t  if (details) {\t\t\t\t\t\n\t    operationRequest.setOperationName(details.Parameters['sn_operation']);\n\t    var contactData = details.ContactData;\n\t    if(contactData) {\n\t\t// Call id should be surfaced in openframe call log so it can be tied to transcription later\n\t\toperationRequest.setParameter('contact.call_id', contactData.ContactId);\n\t\tfor(var ck in contactData.CustomerEndpoint) {\n\t\t  operationRequest.setParameter('contact.' + ck, contactData.CustomerEndpoint[ck]);\n\t       }\n\t       operationRequest.setParameter('contact.id', contactData.ContactId);\n\t       operationRequest.setParameter('contact.phone', contactData.CustomerEndpoint.Address);\n\t    }\n\t    var parameters = details.Parameters;\n\t    if (parameters) {\n\t\tfor (var pk in parameters) {\n\t\t  switch(pk) {\n\t\t    case 'interactionId':\n\t\t\toperationRequest.setInteractionSysId(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'authToken':\n\t\t\toperationRequest.setAuthToken(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'language':\n\t\t\toperationRequest.setLanguage(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'statusCode':\n\t\t    case 'message':\n\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t    default:\n\t\t\toperationRequest.setParameter(pk, parameters[pk]);\n\t\t }\t\t\t\t\t\t\n            }\n          }\t\t\t\t\t\n        }\n      }\n    }\n  } catch(e) {\n\t\tctx.setError(e);\n  }\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": " of message transformer script that saves the passed in authentication token.",
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setAuthToken_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setAuthToken(String id)",
        "order": 12690,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets an authentication token on the current CTIOperationRequest object.",
        "text2": "<p>This token is used by the Cloud Call Center framework to authenticate the current Cloud\n        Call Center user before executing the requested operation handler if the handler's\n          <span class=\"keyword parmname\">auth_required</span> flag is set to true. The\n          <span class=\"keyword parmname\">auth_required</span> flag is a field in the Operation Handler\n        [sn_cti_operation_handler] table. The life of an authentication token should be for the life\n        of the call session, but is determined by the CTI provider.</p><p>You can define whatever authentication/authorization handling required by your\n        implementation by creating your own authentication operation handler. Regardless of how the\n        authentication token is generated, the message translator must pass the token back in the\n        CTI payload. Additionally, the CTI provider must store this authentication token locally and\n        pass it in each operation request that requires authentication.</p><p>If using the instance provided authenticate operation handler, the handler initiates the\n        creation of the authentication token based on a four-digit user-entered pin. It then sets\n        the authentication token in the sessionAttributes object of the CTIOperationResponse object.\n        The associated message transformer translates the sessionAttributes object into the\n        CTI-specific payload and then sends it to the CTI provider.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> If the authentication token is not passed, all requests to execute operation handlers\n          with the <span class=\"keyword parmname\">auth_required</span> flag set will fail. If you do not use\n          authentication, you do not need to maintain authentication tokens.</div></p><p>The <span class=\"ph\">ServiceNow</span> base system provides\n        working operation handlers and message transformers that enable connection to Amazon\n        Connect. When building contact flows within Amazon Connect, there are two integration points\n        between Amazon services and a <span class=\"ph\">ServiceNow</span> instance:<ul class=\"ul\" id=\"CTIOpReq-setAuthToken_S__d668e90\">\n          <li class=\"li\">Amazon Web Services (AWS) Lambda Proxy (Invoke AWS Lambda function)</li>\n\n          <li class=\"li\">AWS Lex Bot (Get Customer Input) </li>\n\n        </ul>\nYou can find the available operation handlers and message transformers for these\n        integration points in the Operation Handlers [sn_cti_operation_handler] and Provider Message\n        Transformer [sn_cti_provider_msg_transormer] tables.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "sys_id",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The sys_id of the interaction record to associate with the request.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>{\t\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n\tvar event = jsonPayload.event;\n\tif (event) {\n\t  var details = event.Details;\n\t  if (details) {\t\t\t\t\t\n\t    operationRequest.setOperationName(details.Parameters['sn_operation']);\n\t    var contactData = details.ContactData;\n\t    if(contactData) {\n\t\t// Call id should be surfaced in openframe call log so it can be tied to transcription later\n\t\toperationRequest.setParameter('contact.call_id', contactData.ContactId);\n\t\tfor(var ck in contactData.CustomerEndpoint) {\n\t\t  operationRequest.setParameter('contact.' + ck, contactData.CustomerEndpoint[ck]);\n\t       }\n\t       operationRequest.setParameter('contact.id', contactData.ContactId);\n\t       operationRequest.setParameter('contact.phone', contactData.CustomerEndpoint.Address);\n\t    }\n\t    var parameters = details.Parameters;\n\t    if (parameters) {\n\t\tfor (var pk in parameters) {\n\t\t  switch(pk) {\n                 // Associate the existing customer interaction record with the request\n\t\t    case 'interactionId':\n\t\t\toperationRequest.setInteractionSysId(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'authToken':\n\t\t\toperationRequest.setAuthToken(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'language':\n\t\t\toperationRequest.setLanguage(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'statusCode':\n\t\t    case 'message':\n\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t    default:\n\t\t\toperationRequest.setParameter(pk, parameters[pk]);\n\t\t }\t\t\t\t\t\t\n            }\n          }\t\t\t\t\t\n        }\n      }\n    }\n  } catch(e) {\n\t\tctx.setError(e);\n  }\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": " of a message transformer script that extracts the interaction record sys_id from\n        the incoming payload (passed as a parameter) and sets it on the associated\n        CTIOperationRequest object.",
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setInteractionSysId_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setInteractionSysId(String Id)",
        "order": 13420,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the sys_id of the interaction record associated with the operation request on the\n    current CTIOperationRequest object.",
        "text2": "<p>If you want to maintain contact interaction information within a contact-specific\n        interaction record, the interaction record sys_id must be maintained for the entire Cloud\n        Call Center call session.</p><p>Typically, an operation handler creates an interaction record when a new contact call is\n        initiated. It then sets the interaction record sys_id and table name on the associated\n        CTIOperationResponse object as session attributes using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setSessionAttribute_S_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setSessionAttribute(String key, Object value)</a>\n        method. The associated method transformer then translates this information into the computer\n        telephony integration (CTI) provider payload and sends it back to the CTI provider.</p><p>The CTI provider must store the interaction record sys_id for the contact session locally.\n        Each time the CTI provider interacts with the Cloud Call Center for this contact session, it\n        must pass back the corresponding interaction record sys_id in its payload. The receiving\n        message transformer then parses the payload and uses the CTIOperationRequest -\n        setInteractionSysId() method to set the interaction record sys_id on the associated\n        CTIOperationtRequest object.</p><p>The <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getInteractionRecord&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getInteractionRecord()</a> method uses\n        this sys_id to obtain the correct interaction record for the contact session. Interaction\n        records are located in the Interaction [interaction] table. For additional information on\n        interaction records, see</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>{\t\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n\tvar event = jsonPayload.event;\n\tif (event) {\n\t  var details = event.Details;\n\t  if (details) {\t\t\t\t\t\n\t    operationRequest.setOperationName(details.Parameters['sn_operation']);\n\t    var contactData = details.ContactData;\n\t    if(contactData) {\n\t\t// Call id should be surfaced in openframe call log so it can be tied to transcription later\n\t\toperationRequest.setParameter('contact.call_id', contactData.ContactId);\n\t\tfor(var ck in contactData.CustomerEndpoint) {\n\t\t  operationRequest.setParameter('contact.' + ck, contactData.CustomerEndpoint[ck]);\n\t       }\n\t       operationRequest.setParameter('contact.id', contactData.ContactId);\n\t       operationRequest.setParameter('contact.phone', contactData.CustomerEndpoint.Address);\n\t    }\n\t    var parameters = details.Parameters;\n\t    if (parameters) {\n\t\tfor (var pk in parameters) {\n\t\t  switch(pk) {\n\t\t    case 'interactionId':\n\t\t\toperationRequest.setInteractionSysId(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'authToken':\n\t\t\toperationRequest.setAuthToken(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'language':\n\t\t\toperationRequest.setLanguage(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'statusCode':\n\t\t    case 'message':\n\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t    default:\n\t\t\toperationRequest.setParameter(pk, parameters[pk]);\n\t\t }\t\t\t\t\t\t\n            }\n          }\t\t\t\t\t\n        }\n      }\n    }\n  } catch(e) {\n\t\tctx.setError(e);\n  }\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "languageCode",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The ISO 639.1 language code to use when processing the associated\n                operation.",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setLanguage_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setLanguage(String languageCode)",
        "order": 13430,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the ISO 639.1 language code to use when processing the associated operation on a\n    CTIOperationRequest object.",
        "text2": "<p>Using the customer preferred language enables you to use platform-provided\n        internationalization and localization capabilities to customize messages and other\n        communications with the associated caller. Typically the message transformer sets the\n        language on the CTIOperationRequest object.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "majorVersion",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Number",
            "text2": "Major version of the CTI provider software making the operation request.<p class=\"p\">If\n                  this value was not previously set, returns\n                <samp class=\"ph systemoutput\">1</samp>.</p>",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nrequest.setMajorVersion(2);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setMajorVersion_N",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setMajorVersion(Number majorVersion)",
        "order": 13540,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the major version of the computer telephony integrator (CTI) provider software\n    making the request on the associated CTIOperationRequest object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span> instance are running multiple versions of their software, as\n        different software versions may require different processing behavior. If the processing\n        behavior is only slightly different between the software versions, it may make sense to have\n        only a single operation handler. You can then handle the processing differences by just\n        checking the version of software making the request and process the request/data within your\n        operation handler. If the required processing is significantly different between versions,\n        it may be more effective to use multiple operation handlers.</p><p>Typically the message transformer sets the software version on the CTIOperationRequest\n        object by calling this method and an operation handler then consumes the set value using the\n          <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getMajorVersion&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getMajorVersion()</a> method. You can also\n        get/set the minor version value of a provider's software using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getMinorVersion&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getMinorVersion()</a> and <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setMinorVersion_N&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setMinorVersion(Number minorVersion)</a>\n        methods.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "minorVersion",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Number",
            "text2": "Minor version of the CTI provider software making the operation request.<p class=\"p\">If\n                  this value was not previously set, returns\n                <samp class=\"ph systemoutput\">0</samp>.</p>",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\n...\nrequest.setMinorVersion(3);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setMinorVersion_N",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setMinorVersion(Number minorVersion)",
        "order": 13630,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the minor version of the computer telephony integrator (CTI) provider software\n    making the request on the associated CTIOperationRequest object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span> instance are running multiple versions of their software, as\n        different software versions may require different processing behavior. If the processing\n        behavior is only slightly different between the software versions, it may make sense to have\n        only a single operation handler. You can then handle the processing differences by just\n        checking the version of software making the request and process the request/data within your\n        operation handler. If the required processing is significantly different between versions,\n        it may be more effective to use multiple operation handlers.</p><p>Typically the message transformer sets the software version on the CTIOperationRequest\n        object by calling this method and an operation handler then consumes the set value using the\n          <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getMinorVersion&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getMinorVersion()</a> method. You can also\n        get/set the major version value of a provider's software using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getMajorVersion&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getMajorVersion()</a> and <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setMajorVersion_N&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setMajorVersion(Number majorVersion)</a>\n        methods.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>{\t\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n\tvar event = jsonPayload.event;\n\tif (event) {\n\t  var details = event.Details;\n\t  if (details) {\t\n           // Set the operation handler to use to process the request\t\t\t\t\n\t    operationRequest.setOperationName(details.Parameters['sn_operation']);\n\t    var contactData = details.ContactData;\n\t    if(contactData) {\n\t\t// Call id should be surfaced in openframe call log so it can be tied to transcription later\n\t\toperationRequest.setParameter('contact.call_id', contactData.ContactId);\n\t\tfor(var ck in contactData.CustomerEndpoint) {\n\t\t  operationRequest.setParameter('contact.' + ck, contactData.CustomerEndpoint[ck]);\n\t       }\n\t       operationRequest.setParameter('contact.id', contactData.ContactId);\n\t       operationRequest.setParameter('contact.phone', contactData.CustomerEndpoint.Address);\n\t    }\n\t    var parameters = details.Parameters;\n\t    if (parameters) {\n\t\tfor (var pk in parameters) {\n\t\t  switch(pk) {\n\t\t    case 'interactionId':\n\t\t\toperationRequest.setInteractionSysId(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'authToken':\n\t\t\toperationRequest.setAuthToken(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'language':\n\t\t\toperationRequest.setLanguage(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'statusCode':\n\t\t    case 'message':\n\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t    default:\n\t\t\toperationRequest.setParameter(pk, parameters[pk]);\n\t\t }\t\t\t\t\t\t\n            }\n          }\t\t\t\t\t\n        }\n      }\n    }\n  } catch(e) {\n\t\tctx.setError(e);\n  }\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "name",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The name of the operation that the CTI provider is currently attempting to\n                execute. <p class=\"p\">This name must be the same as the name of the operation handler to use\n                  to process the request. If it is not, an error is thrown. You can locate the\n                  available operation handlers in the Operation Handler [sn_cti_operation_handler]\n                  table. </p>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setOperationName_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setOperationName(String name)",
        "order": 13780,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the name of the operation that the computer telephony integration (CTI) provider\n    is attempting to execute on the current CTIOperationRequest object.",
        "text2": "<p>The operation name determines the operation handler that is used to process the request.\n        Call this method from the associated message transformer.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> For Amazon Connect Lex\n          Bot implementations, intent names are appended with a five letter suffix as different\n          Amazon intents cannot have the same intent name. In the Cloud Call Center framework, the\n          intent name equals the operation handler name. An operation handler can either be specific\n          for an intent, having an operation handler name that includes this suffix\n          (myOperation_SUFFX), or it can be generic and used by multiple CTI providers or different\n          use cases, such as using the same handler for processing an HR request and a helpdesk\n          request (myOperation).</div></p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*HTTPRequest*/ httpRequest, /*CTIOperationRequest*/ operationRequest, /*Context*/ ctx) {\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n      var event = jsonPayload.event;\n      if (event) {\n        var intent = event.currentIntent;\n\t var inputTranscript = event.inputTranscript;\n\t if(inputTranscript) {\n\t   operationRequest.setParameter('$utterance', inputTranscript);\n\t }\n        if (intent) {\n          operationRequest.setOperationName(intent.name);\n\t   // Add this because intent name gets changed through the pipeline\n\t   operationRequest.setParameter('$original_intent', intent.name);\n          var sessionAttributes = event.sessionAttributes;\n          if (sessionAttributes) {\n            for (var sk in sessionAttributes) {\n              switch (sk) {\n                case 'interactionId':\n                  operationRequest.setInteractionSysId(sessionAttributes[sk]);\n                  break;\n                case 'authToken':\n                  operationRequest.setAuthToken(sessionAttributes[sk]);\n                  break;\n\t\t  case 'language':\n\t\t    operationRequest.setLanguage(sessionAttributes[sk]);\n\t\t    break;\n                case 'statusCode':\n                case 'message':\n                  break;\n                default:\n                  operationRequest.setSessionAttribute(sk, sessionAttributes[sk]);\n              }\n            }\n          }\n          var slots = intent.slots;\n\t   // Always copy in slots they are the parameters for the operation\n          if (slots) {\n            for (var pk in slots) {\n              operationRequest.setParameter(pk, slots[pk]);\n            }\n          }\n          var invocationSource = event.invocationSource;\n\t   operationRequest.setParameter('$$invocationSource', invocationSource);\n          // Specific handling for dialog hooks with a way to override for Amazon specific provider\n          if (invocationSource === 'DialogCodeHook') {\n\t     // Set substep to trigger forwarding to another handler IF it s present\n\t     operationRequest.setOperationSubStepName(invocationSource);\n\t     // Allow pass through behavior\n\t     var behaviourToUse = sn_cti_core.CTIOperationRequest.OperationNotFoundBehaviours.PassThrough;\n\t     operationRequest.setSubStepNotFoundBehaviour(behaviourToUse);\n\t     // Reserved - copy slots in so we can just use delegate as default if the call isn't handled\n\t     operationRequest.setParameter('$$slots', slots);\n          }\n        }\n      }\n    }\n  } catch (e) {\n      ctx.setError(e);\n  }\n  return operationRequest;\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "name",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The name of the substep that the CTI provider is trying to execute.",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setOperationSubStepName_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setOperationSubStepName(String name)",
        "order": 13790,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the operation substep name on the current CTIOperationRequest object.",
        "text2": "<p>Use substeps to perform actions such as initialization and validation before processing an\n        operation. Unlike operation handlers that are meant to be generic and used by all CTI\n        providers, substeps are CTI provider specific and use terminology and naming conventions\n        that are specific to the CTI provider.</p><p>The Cloud Call Center framework performs the following steps to locate the required\n        operation handler and any associated substep operation handlers.<div class=\"note note\" id=\"CTIOpReq-setOperationSubStepName_S__d668e108\"><span class=\"notetitle\">Note:</span> For Amazon Connect Lex\n          Bot implementations, intent names are appended with a five letter suffix as different\n          Amazon intents cannot have the same intent name. In the Cloud Call Center framework, the\n          intent name equals the operation handler name. An operation handler can either be specific\n          for an intent, having an operation handler name that includes this suffix\n          (myOperation_SUFFX), or it can be generic and used by multiple CTI providers or different\n          use cases, such as using the same handler for processing an HR request and a helpdesk\n          request (myOperation).</div>\n<ol class=\"ol\" id=\"CTIOpReq-setOperationSubStepName_S__d668e110\">\n          <li class=\"li\">Tries to locate the operation handler associated with the request. <ul class=\"ul\" id=\"CTIOpReq-setOperationSubStepName_S__d668e114\">\n              <li class=\"li\">First checks for an operation handler called <code class=\"ph codeph\">myOperation_SUFFX</code>. </li>\n\n              <li class=\"li\">If not found, checks for the operation handler <code class=\"ph codeph\">myOperation</code>. If\n                not found, errors out.</li>\n\n            </ul>\n</li>\n\n          <li class=\"li\">If the handler is found, checks the <span class=\"keyword parmname\">auth_required</span> flag on the\n            operation handler. If set, it checks that a valid authentication token (obtained through\n            the <span class=\"keyword apiname\">getAuthToken()</span> method) is present on the request. If present and\n            valid, continue processing, else throw an error.</li>\n\n          <li class=\"li\">Looks up the operation handler for the passed in substep. For this example let's\n            assume <code class=\"ph codeph\">subStepName=SubStep</code>.<ul class=\"ul\" id=\"CTIOpReq-setOperationSubStepName_S__d668e143\">\n              <li class=\"li\">First checks for an operation handler named\n                  <code class=\"ph codeph\">myOperation_SUFFX.SubStep</code>. If found, executes the handler.</li>\n\n              <li class=\"li\">If not found, checks for the handler <code class=\"ph codeph\">myOperation.SubStep</code>. If\n                found executes the handler.</li>\n\n              <li class=\"li\">If not found, checks if a <code class=\"ph codeph\">subStepNotFoundBehavior</code> was set on the\n                request object.</li>\n\n              <li class=\"li\">If set, executes the behavior, otherwise, errors out.</li>\n\n            </ul>\n</li>\n\n          <li class=\"li\">Executes the primary operation handler (<code class=\"ph codeph\">myOpersation_SUFFX</code> or\n              <code class=\"ph codeph\">myOperation</code>.)</li>\n\n        </ol></p><p>You can set the default behavior of a substep by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-setSubStepNotFoundBehav_O&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          setSubStepNotFoundBehaviour(Object behaviour)</a> method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>{\t\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n\tvar event = jsonPayload.event;\n\tif (event) {\n\t  var details = event.Details;\n\t  if (details) {\t\t\t\t\t\n\t    operationRequest.setOperationName(details.Parameters['sn_operation']);\n\t    var contactData = details.ContactData;\n\t    if(contactData) {\n\t\t// Call id should be surfaced in openframe call log so it can be tied to transcription later\n\t\toperationRequest.setParameter('contact.call_id', contactData.ContactId);\n\t\tfor(var ck in contactData.CustomerEndpoint) {\n\t\t  operationRequest.setParameter('contact.' + ck, contactData.CustomerEndpoint[ck]);\n\t       }\n\t       operationRequest.setParameter('contact.id', contactData.ContactId);\n\t       operationRequest.setParameter('contact.phone', contactData.CustomerEndpoint.Address);\n\t    }\n\t    var parameters = details.Parameters;\n\t    if (parameters) {\n\t\tfor (var pk in parameters) {\n\t\t  switch(pk) {\n\t\t    case 'interactionId':\n\t\t\toperationRequest.setInteractionSysId(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'authToken':\n\t\t\toperationRequest.setAuthToken(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'language':\n\t\t\toperationRequest.setLanguage(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'statusCode':\n\t\t    case 'message':\n\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t    default:\n\t\t\toperationRequest.setParameter(pk, parameters[pk]);\n\t\t }\t\t\t\t\t\t\n            }\n          }\t\t\t\t\t\n        }\n      }\n    }\n  } catch(e) {\n\t\tctx.setError(e);\n  }\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "Name of the key under which to store the associated value.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "value",
            "order": 20,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Object",
            "text2": "Value to store.<div class=\"p\">Valid data types:<ul class=\"ul\" id=\"CTIOpReq-setParameter_S_O__ul_mcs_2sr_zkb\">\n                    <li class=\"li\">string</li>\n\n                    <li class=\"li\">int</li>\n\n                    <li class=\"li\">float</li>\n\n                    <li class=\"li\">number</li>\n\n                    <li class=\"li\">boolean</li>\n\n                    <li class=\"li\">date</li>\n\n                    <li class=\"li\">object</li>\n\n                  </ul>\n</div>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setParameter_S_O",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setParameter(String key, Object value)",
        "order": 13800,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the specified key-value pair on the parameter object of the current\n    CTIOperationRequest object.",
        "text2": "<p>Using the get/set parameter methods enables the passing of virtually any string or number\n        value between a message transformer and an operation handler. The parameter object can\n        contain zero or more key/value pairs of data that directly correlate to the current\n        operation request. The operation handler determines what key/value pairs are required as it\n        consumes these values. Typically the message transformer sets these parameters on the\n        CTIOperationRequest object by calling this method and the operation handler consumes them\n        using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getParameter_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getParameter(String key)</a> or <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getParameters&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getParameters()</a> method.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> You should only store objects that can survive a\n            <code class=\"ph codeph\">JSON.parse(JSON.stringify(object))</code> operation. Objects not meeting this\n          criteria may not propagate correctly through the entire operation processing chain.</div></p><p>For\n        example:<pre class=\"pre codeblock\"><code>var x = {\n  \"string\": 'abc',\n  \"int\": 123,\n  \"float\": 1.234,\n  \"number\": new Number(3),\n  \"boolean\": true,\n  \"date\": new Date(2006, 0, 2, 15, 4, 5),\n  \"object\": {\n    \"string\": 'abc',\n    \"int\": 123,\n    \"float\": 1.234,\n    \"number\": new Number(3),\n    \"boolean\": true,\n    \"date\": new Date(2006, 0, 2, 15, 4, 5)\n  },\n  \"function\": function(abc) {\n\n  }\n}\nvar stringify = JSON.stringify(x);\ngs.info(stringify);\nvar hydrate = JSON.parse(stringify);\nvar stringify2 = JSON.stringify(hydrate);\ngs.info(stringify2);\n</code></pre></p><p>Produces:<pre class=\"pre codeblock\"><code>{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n</code></pre></p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationRequest('origin');\nrequest.setSessionAttribute('contact.phone', '+15552222345');\nrequest.setSessionAttribute('contact.okToCall', true);\nrequest.setSessionAttribute('contact.address', {\n    street: '1234 Main St'\n    city: 'API City',\n    zip: 91335\n});</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "Name of the key under which to store the associated value.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "value",
            "order": 20,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Object",
            "text2": "Value to store.<div class=\"p\">Valid data types:<ul class=\"ul\" id=\"CTIOpReq-setSessionAttribute_S_O__ul_mcs_2sr_zkb\">\n                    <li class=\"li\">string</li>\n\n                    <li class=\"li\">int</li>\n\n                    <li class=\"li\">float</li>\n\n                    <li class=\"li\">number</li>\n\n                    <li class=\"li\">boolean</li>\n\n                    <li class=\"li\">date</li>\n\n                    <li class=\"li\">object</li>\n\n                  </ul>\n</div>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setSessionAttribute_S_O",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setSessionAttribute(String key, Object value)",
        "order": 14090,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the specified session attribute key-value pair on the current CTIOperationRequest\n    object.",
        "text2": "<p>Using the get/set session attribute methods enables the passing of virtually any string or\n        number value between a message transformer and an operation handler. The sessionAttribute\n        object can contain zero or more key/value pairs of data that are valid for the duration of a\n        computer telephony integration provider defined session. Session attributes can also be\n        accessed within a contact flow. The operation handler determines what session attribute\n        key/value pairs are needed as it consumes these values. Typically the message transformer\n        sets these attributes on the CTIOperationRequest object by calling this method and the\n        operation handler gets the attributes using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getSessionAttribute_S&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getSessionAttribute(String key)</a> or <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpReq-getSessionAttributes&amp;v=paris\" target=\"_blank\">CTIOperationRequest -\n          getSessionAttribute()</a> method.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> You should only store objects that can survive a\n            <code class=\"ph codeph\">JSON.parse(JSON.stringify(object))</code> operation. Objects not meeting this\n          criteria may not propagate correctly through the entire operation processing chain.</div></p><p>For\n        example:<pre class=\"pre codeblock\"><code>var x = {\n  \"string\": 'abc',\n  \"int\": 123,\n  \"float\": 1.234,\n  \"number\": new Number(3),\n  \"boolean\": true,\n  \"date\": new Date(2006, 0, 2, 15, 4, 5),\n  \"object\": {\n    \"string\": 'abc',\n    \"int\": 123,\n    \"float\": 1.234,\n    \"number\": new Number(3),\n    \"boolean\": true,\n    \"date\": new Date(2006, 0, 2, 15, 4, 5)\n  },\n  \"function\": function(abc) {\n\n  }\n}\nvar stringify = JSON.stringify(x);\ngs.info(stringify);\nvar hydrate = JSON.parse(stringify);\nvar stringify2 = JSON.stringify(hydrate);\ngs.info(stringify2);\n</code></pre></p><p>Produces:<pre class=\"pre codeblock\"><code>{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n</code></pre></p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "behaviour",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "OperationNotFoundBehaviours",
            "text2": "Behavior to use if a handling behavior is not specified for the substep. This\n                must be a behavior defined on the CTIOperationRequest.OperationNotFoundBehaviours\n                  object.<div class=\"p\">Possible values:<ul class=\"ul\" id=\"CTIOpReq-setSubStepNotFoundBehav_O__ul_kbc_53f_1lb\">\n                    <li class=\"li\">ThrowError: Throw an error.</li>\n\n                    <li class=\"li\">PassThrough: Do not perform any further processing on the request, just\n                      return.</li>\n\n                    <li class=\"li\">RouteToOperation: Use the parent operation handler\n                        <span class=\"keyword parmname\">&lt;operation_name&gt;</span>.</li>\n\n                  </ul>\n</div>",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*HTTPRequest*/ httpRequest, /*CTIOperationRequest*/ operationRequest, /*Context*/ ctx) {\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n      var event = jsonPayload.event;\n      if (event) {\n        var intent = event.currentIntent;\n\t var inputTranscript = event.inputTranscript;\n\t if(inputTranscript) {\n\t   operationRequest.setParameter('$utterance', inputTranscript);\n\t }\n        if (intent) {\n          operationRequest.setOperationName(intent.name);\n\t   // Add this because intent name gets changed through the pipeline\n\t   operationRequest.setParameter('$original_intent', intent.name);\n          var sessionAttributes = event.sessionAttributes;\n          if (sessionAttributes) {\n            for (var sk in sessionAttributes) {\n              switch (sk) {\n                case 'interactionId':\n                  operationRequest.setInteractionSysId(sessionAttributes[sk]);\n                  break;\n                case 'authToken':\n                  operationRequest.setAuthToken(sessionAttributes[sk]);\n                  break;\n\t\t  case 'language':\n\t\t    operationRequest.setLanguage(sessionAttributes[sk]);\n\t\t    break;\n                case 'statusCode':\n                case 'message':\n                  break;\n                default:\n                  operationRequest.setSessionAttribute(sk, sessionAttributes[sk]);\n              }\n            }\n          }\n          var slots = intent.slots;\n\t   // Always copy in slots they are the parameters for the operation\n          if (slots) {\n            for (var pk in slots) {\n              operationRequest.setParameter(pk, slots[pk]);\n            }\n          }\n          var invocationSource = event.invocationSource;\n\t   operationRequest.setParameter('$$invocationSource', invocationSource);\n          // Specific handling for dialog hooks with a way to overide for Amazon specific provider\n          if (invocationSource === 'DialogCodeHook') {\n\t     // Set substep to trigger forwarding to another handler IF it s present\n\t     operationRequest.setOperationSubStepName(invocationSource);\n\t     // Allow pass through behavior\n\t     var behaviourToUse = sn_cti_core.CTIOperationRequest.OperationNotFoundBehaviours.PassThrough;\n\t     operationRequest.setSubStepNotFoundBehaviour(behaviourToUse);\n\t     // Reserved - copy slots in so we can just use delegate as default if the call isn't handled\n\t     operationRequest.setParameter('$$slots', slots);\n          }\n        }\n      }\n    }\n  } catch (e) {\n      ctx.setError(e);\n  }\n  return operationRequest;\n})(httpRequest, operationRequest, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpReq-setSubStepNotFoundBehav_O",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setSubStepNotFoundBehaviour(Object behaviour)",
        "order": 14240,
        "parentId": "CTIOperationRequestAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationrequest___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the behavior to perform if the current substep's operation handler is not\n    found.",
        "text2": "<p>This method should be called by the input message transformer.</p>",
        "type": "Method",
        "variable": null
      }
    ],
    "dc_identifier": "CTIOperationRequestAPI",
    "is_current": true,
    "is_highlighted": true,
    "level": "Class",
    "name": "CTIOperationRequest - Scoped, Global",
    "namespace_id": "sn_cti_core-namespace",
    "release": "paris",
    "text": "The <span class=\"keyword apiname\">CTIOperationRequest</span> API provides methods to set and get data on\n    the current CTIOperationRequest object.",
    "text2": "You use CTIOperationRequest objects to pass information between a message transformer and an\n      operation handler within the Cloud Call Center framework.<br/><br/>Typically, a message transformer is responsible for parsing an incoming CTI-specific payload\n      and setting the payload data on an associated CTIOperationRequest object. An operation handler\n      is then responsible for getting the information from the CTIOperationRequest object and using\n      the data to process the requested operation.<br/><br/>The <span class=\"ph\">ServiceNow</span> base system provides\n        working operation handlers and message transformers that enable connection to Amazon\n        Connect. When building contact flows within Amazon Connect, there are two integration points\n        between Amazon services and a <span class=\"ph\">ServiceNow</span> instance:<ul class=\"ul\" id=\"CTIOperationRequestAPI__d3914e90\">\n          <li class=\"li\">Amazon Web Services (AWS) Lambda Proxy (Invoke AWS Lambda function)</li>\n\n          <li class=\"li\">AWS Lex Bot (Get Customer Input) </li>\n\n        </ul>\nYou can find the available operation handlers and message transformers for these\n        integration points in the Operation Handlers [sn_cti_operation_handler] and Provider Message\n        Transformer [sn_cti_provider_msg_transormer] tables.<br/><br/>A payload is passed into a <span class=\"ph\">ServiceNow</span> instance from an external source,\n      such as from a computer telephony integration (CTI) provider that is making an operation\n      request. When a request is received, a message transformer parses the payload and uses the\n      CTIOperationRequest set methods to set payload values, such as the operation handler name,\n      onto an operation and contact-specific CTIOperationRequest object.<br/><br/>The following message transformer script parses the passed in JSON payload and sets the\n      values required by the associated operation handler on the CTIOperationRequest object.<br/><br/><pre><code class='language-javascript'><code>{\t\n  try {\n    var jsonPayload = httpRequest.body.data;\n    if (jsonPayload) {\n\tvar event = jsonPayload.event;\n\tif (event) {\n\t  var details = event.Details;\n\t  if (details) {\t\t\t\t\t\n\t    operationRequest.setOperationName(details.Parameters['sn_operation']);\n\t    var contactData = details.ContactData;\n\t    if(contactData) {\n\t\t// Call id should be surfaced in openframe call log so it can be tied to transcription later\n\t\toperationRequest.setParameter('contact.call_id', contactData.ContactId);\n\t\tfor(var ck in contactData.CustomerEndpoint) {\n\t\t  operationRequest.setParameter('contact.' + ck, contactData.CustomerEndpoint[ck]);\n\t       }\n\t       operationRequest.setParameter('contact.id', contactData.ContactId);\n\t       operationRequest.setParameter('contact.phone', contactData.CustomerEndpoint.Address);\n\t    }\n\t    var parameters = details.Parameters;\n\t    if (parameters) {\n\t\tfor (var pk in parameters) {\n\t\t  switch(pk) {\n\t\t    case 'interactionId':\n\t\t\toperationRequest.setInteractionSysId(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'authToken':\n\t\t\toperationRequest.setAuthToken(parameters[pk]);\n\t\t\tbreak;\n\t\t    case 'language':\n\t\t\toperationRequest.setLanguage(parameters[pk]);\n\t\t\tbreak;\n\t\t\t\t\t\t\t\t\n\t\t    default:\n\t\t\toperationRequest.setParameter(pk, parameters[pk]);\n\t\t }\t\t\t\t\t\t\n            }\n          }\t\t\t\t\t\n        }\n      }\n    }\n  } catch(e) {\n\t\tctx.setError(e);\n  }\n})(httpRequest, operationRequest, ctx);</code></code></pre><br/><br/>After the message transformer finishes parsing the passed in payload, the Cloud Call Center\n      framework instantiates the specified operation handler. The operating handler uses the\n        <span class=\"keyword apiname\">CTIOperationResponse</span> API get methods to obtain the information that it\n      needs from the associated CTIOperationRequest object to process the requested operation.<br/><br/>The following operation handler script stores values that were set on the CTIOperationRequest\n      object in the interaction record associated with the call.<br/><br/><pre><code class='language-javascript'><code>(function( /*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response, ctx) {\n  // Returns the sys_id of the interaction record.\n  var interactionSysId = request.getInteractionSysId();\n  var number = request.getParameter('number');\n  var addComment = request.getParameter('add_comment');\n  addComment = addComment ? addComment.toLowerCase() : addComment;\n  addComment = 'yes' === addComment || 'true' === addComment || '1' === addComment;\n  var workNotes = request.getParameter('work_notes');\n  var message = gs.getMessage('Thankyou');\n  var interactionGr = request.getInteractionRecord();\n  var openedFor = interactionGr ? interactionGr.getValue('opened_for') : null;\n  if (openedFor &amp;&amp; number &amp;&amp; addComment &amp;&amp; workNotes) {\n    var now_GR = new GlideRecordSecure('incident');\n    now_GR.addQuery('caller_id', openedFor);\n    now_GR.addQuery('number', number);\n    now_GR.query();\n    if (now_GR.next()) {\n      now_GR.work_notes += workNotes;\n      now_GR.update();\n      message = gs.getMessage('Your comment was added');\n    }\n  }\n  response.setStatusCode(200);\n  response.setMessage(message);\n})(request, response, ctx);</code></code></pre><br/><br/>For additional information on creating operation handlers, see <a class=\"xref\" href=\"https://docs.servicenow.com/bundle/paris-servicenow-platform/page/product/cloud-call-center/task/establish-automated-bot-interactions.html\" target=\"_blank\">Configure a contact flow for an\n        automated caller interaction</a>.<br/><br/>This API runs in the <span class=\"keyword parmname\">sn_cti_core</span> namespace. Before you are able to\n      access the <span class=\"keyword apiname\">CTIOperationRequest</span> API, the Cloud Call Center Core\n      (sn_cti_core) plugin must be activated. For information on activating the Cloud Call Center,\n      see <a class=\"xref\" href=\"https://docs.servicenow.com/bundle/paris-servicenow-platform/page/product/cloud-call-center/task/install-ccc-apps.html\" target=\"_blank\">Install Cloud Call Center\n        applications</a>.<br/><br/>For additional information on the Cloud Call Center, see <a class=\"xref\" href=\"https://docs.servicenow.com/bundle/paris-servicenow-platform/page/product/cloud-call-center/concept/cloud-call-center-overview.html\" target=\"_blank\">Cloud Call Center</a>.",
    "type": "Server Side Scoped",
    "variable": ""
  },
  {
    "children": [
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nresponse.setMinorVersion(3);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-CTIOperationResp_S",
        "hasExample": true,
        "name": "CTIOperationResponse(String origin)",
        "order": 1850,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Instantiates a CTIOperationResponse object.",
        "text2": null,
        "type": "Constructor",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nvar token = response.getAuthToken();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The authentication token previously set on the CTIOperationRequest object. If\n                not set, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getAuthToken",
        "hasExample": true,
        "hasReturn": true,
        "name": "getAuthToken()",
        "order": 5720,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the authentication token that was set on the CTIOperationResponse\n    object.",
        "text2": "<p>This token is used by the Cloud Call Center framework to authenticate the current Cloud\n        Call Center user before executing the requested operation handler if the handler's\n          <span class=\"keyword parmname\">auth_required</span> flag is set to true. The\n          <span class=\"keyword parmname\">auth_required</span> flag is a field in the Operation Handler\n        [sn_cti_operation_handler] table. The life of an authentication token should be for the life\n        of the call session, but is determined by the CTI provider.</p><p>You can define whatever authentication/authorization handling required by your\n        implementation by creating your own authentication operation handler. Regardless of how the\n        authentication token is generated, the message translator must pass the token back in the\n        CTI payload. Additionally, the CTI provider must store this authentication token locally and\n        pass it in each operation request that requires authentication.</p><p>If using the instance provided authenticate operation handler, the handler initiates the\n        creation of the authentication token based on a four-digit user-entered pin. It then sets\n        the authentication token in the sessionAttributes object of the CTIOperationResponse object.\n        The associated message transformer translates the sessionAttributes object into the\n        CTI-specific payload and then sends it to the CTI provider.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> If the authentication token is not passed, all requests to execute operation handlers\n          with the <span class=\"keyword parmname\">auth_required</span> flag set will fail. If you do not use\n          authentication, you do not need to maintain authentication tokens.</div></p><p>The <span class=\"ph\">ServiceNow</span> base system provides\n        working operation handlers and message transformers that enable connection to Amazon\n        Connect. When building contact flows within Amazon Connect, there are two integration points\n        between Amazon services and a <span class=\"ph\">ServiceNow</span> instance:<ul class=\"ul\" id=\"CTIOpResp-getAuthToken__d413e90\">\n          <li class=\"li\">Amazon Web Services (AWS) Lambda Proxy (Invoke AWS Lambda function)</li>\n\n          <li class=\"li\">AWS Lex Bot (Get Customer Input) </li>\n\n        </ul>\nYou can find the available operation handlers and message transformers for these\n        integration points in the Operation Handlers [sn_cti_operation_handler] and Provider Message\n        Transformer [sn_cti_provider_msg_transormer] tables.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*CTIProviderResponseExecutionContext*/ ctx, /*CTIOperationRequest*/ operationRequest, /*CTIOperationResponse*/ operationResponse, /*HTTPResponse*/ httpResponse) {\n    var sessionAttributes = {},\n        intentResponse;\n    var statusCode = -1;\n    var message = 'Unprocessed';\n    if (operationResponse) {\n        statusCode = operationResponse.getStatusCode();\n        sessionAttributes = operationResponse.getSessionAttributes();\n        message = operationResponse.getMessage();\n        var error = operationResponse.getError();\n        if (error) {\n            sessionAttributes.error = error;\n        }\n    }\n    if (sn_cti_core.CTIRequestDispatcher.Constants.HTTP.Status.AUTH_REQUIRED.code === statusCode) {\n        //first call for a secure action without authentication token\n        sessionAttributes.statusCode = 401;\n        sessionAttributes.message = message;\n        intentResponse = {\n            sessionAttributes: sessionAttributes,\n            dialogAction: {\n                type: 'Close',\n                fulfillmentState: 'Fulfilled',\n                message: {\n                    contentType: 'PlainText',\n                    content: 'This operation requires authentication. Say authenticate for authentication.'\n                }\n            }\n        };\n    } else if ('DialogCodeHook' === operationRequest.getParameter('$$invocationSource')) {\n        //pass back authToken and interactionId\n        sessionAttributes.authToken = operationRequest.getAuthToken();\n        sessionAttributes.interactionId = operationRequest.getInteractionSysId();\n\t\tvar originalSlots = operationRequest.getParameter('$$slots');\n        var responseParameters = operationResponse ? operationResponse.getParameters() : {};\n        responseParameters = responseParameters ? responseParameters : {};\n        // See if we processing happened and we got a dialogAction\n\t\tvar responseDialogAction = responseParameters['dialogAction'];\n\t\t// Default dialog action\n        var dialogAction = {\n            type: 'Delegate',\n            slots: originalSlots\n        };\n\t\t// If the response doesn't contain an override replay the inputs\n        if (responseDialogAction) {\n            // We bypassed dialoghook so delegate and pass through inputs\n            dialogAction = responseDialogAction;\n        }\n        intentResponse = {\n            sessionAttributes: sessionAttributes,\n            dialogAction: dialogAction\n        };\n    } else {\n        // Override required session attributes\n        sessionAttributes.statusCode = statusCode;\n        sessionAttributes.message = message;\n        // Build response template\n        intentResponse = {\n            sessionAttributes: sessionAttributes,\n            dialogAction: {\n                type: 'Close',\n                fulfillmentState: 'Fulfilled',\n                message: {\n                    contentType: 'PlainText',\n                    content: message\n                }\n            }\n        };\n    }\n    httpResponse.setBody(intentResponse);\n})(ctx, operationRequest, operationResponse, httpResponse);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Object",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Operation error information. The format of this object is determined by the CTI\n                provider. If an error does not exist, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getError",
        "hasExample": true,
        "hasReturn": true,
        "name": "getError()",
        "order": 7110,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the error object associated with the current CTIOperationResponse\n    object.",
        "text2": "<p>You might use this information to formulate the payload returned to the computer telephony\n        integration (CTI) provider.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationResponse();\nvar interactionId = request.getInteractionSysId();\n</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The sys_id of the interaction record set on the CTIOperationResponse object.\n                Interaction records are located in the Interaction [interaction] table.<p class=\"p\">If the\n                  interaction record sys_id is not set, the method returns null.</p>",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getInteractionSysId",
        "hasExample": true,
        "hasReturn": true,
        "name": "getInteractionSysId()",
        "order": 7780,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the sys_id of the interaction record associated with the call session that was\n    set on the CTIOperationResponse object.",
        "text2": "<p>The <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setInteractionSysId_S&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setInteractionSysId(String Id)</a>\n         method must have been called prior to\n        calling this method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationResponse();\nvar majorVersion = response.getMajorVersion();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Major version number of the CTI software.<p class=\"p\">If the major version was never set,\n                  returns <samp class=\"ph systemoutput\">1</samp>. </p>",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getMajorVersion",
        "hasExample": true,
        "hasReturn": true,
        "name": "getMajorVersion()",
        "order": 8090,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the major version of the computer telephony integrator (CTI) software set on\n    the current CTIOperationResponse object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span>\n        instance are running multiple versions of their software, as different software versions may\n        require different payloads. If the payload is only slightly different between the software\n        versions, it may make sense to have only a single message transformer. You can then handle\n        the payload differences by just checking the version of software making the request within\n        your message transformer. If the required payload is significantly different between\n        versions, it may be more effective to use multiple message transformers.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function (/*CTIOperationResponse*/operationResponse, /*HTTPResponse*/ httpResponse) {\n  // AWS Connect Lambda expects name value pairs only\n  var out = {};\n  for(var k in operationResponse.getSessionAttributes()) {\n    out[k] = operationResponse.getSessionAttributes()[k];\n  }\n  out.statusCode = operationResponse.getStatusCode();\n  out.message = operationResponse.getMessage();\n  httpResponse.setBody(out);\n})(operationResponse, httpResponse);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Message text. If no message exists, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getMessage",
        "hasExample": true,
        "hasReturn": true,
        "name": "getMessage()",
        "order": 8180,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the message string set on the current CTIOperationResponse object.",
        "text2": "<p>Typically this is a message that is spoken back to the user once an operation is complete.\n        You can set this value using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setMessage_S&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setMessage(String message)</a> method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationResponse();\nvar minorVersion = request.getMinorVersion();</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Minor version number of the payload associated with this interaction.<p class=\"p\">If the\n                  minor version was never set, returns <samp class=\"ph systemoutput\">0</samp>. </p>",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getMinorVersion",
        "hasExample": true,
        "hasReturn": true,
        "name": "getMinorVersion()",
        "order": 8220,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the minor version of the computer telephony integrator (CTI) software set on\n    the current CTIOperationResponse object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span>\n        instance are running multiple versions of their software, as different software versions may\n        require different payloads. If the payload is only slightly different between the software\n        versions, it may make sense to have only a single message transformer. You can then handle\n        the payload differences by just checking the version of software making the request within\n        your message transformer. If the required payload is significantly different between\n        versions, it may be more effective to use multiple message transformers.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The value of the passed in key. If no such key exists, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The name of the key value to return.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationResponse();\nvar parm = request.getParameter('contact.phone');</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getParameter_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "getParameter(String key)",
        "order": 8530,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the value of a specified key previously set on the current CTIOperationResponse\n    object.",
        "text2": "<p>Using the get/set parameter methods enables the passing of\n        virtually any string or number value between an operation handler and a message transformer.\n        The parameter object can contain zero or more key/value pairs of data that directly\n        correlate to the current operation response. The operation handler determines what key/value\n        pairs are required as it produces these values. Use the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setParameter_S_O&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setParameter(String key, Object value)</a>\n         method to set parameters on the\n        current CTIOperationResponse object.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function( /*CTIProviderResponseExecutionContext*/ ctx, /*CTIOperationRequest*/ operationRequest, /*CTIOperationResponse*/ operationResponse, /*HTTPResponse*/ httpResponse) {\n  var sessionAttributes = {},\n      intentResponse;\n  var statusCode = -1;\n  var message = 'Unprocessed';\n  if (operationResponse) {\n    statusCode = operationResponse.getStatusCode();\n    sessionAttributes = operationResponse.getSessionAttributes();\n    message = operationResponse.getMessage();\n    var error = operationResponse.getError();\n    if (error) {\n      sessionAttributes.error = error;\n    }\n  }\n  if (sn_cti_core.CTIRequestDispatcher.Constants.HTTP.Status.AUTH_REQUIRED.code === statusCode) {\n    //first call for a secure action without authentication token\n    sessionAttributes.statusCode = 401;\n    sessionAttributes.message = message;\n    intentResponse = {\n      sessionAttributes: sessionAttributes,\n      dialogAction: {\n        type: 'Close',\n        fulfillmentState: 'Fulfilled',\n        message: {\n          contentType: 'PlainText',\n          content: 'This operation requires authentication. Say authenticate for authentication.'\n        }\n      }\n    };\n  } else if ('DialogCodeHook' === operationRequest.getParameter('$$invocationSource')) {\n      //pass back authToken and interactionId\n      sessionAttributes.authToken = operationRequest.getAuthToken();\n      sessionAttributes.interactionId = operationRequest.getInteractionSysId();\n      var originalSlots = operationRequest.getParameter('$$slots');\n      var responseParameters = operationResponse ? operationResponse.getParameters() : {};\n      responseParameters = responseParameters ? responseParameters : {};\n      // See if processing happened and we got a dialogAction\n      var responseDialogAction = responseParameters['dialogAction'];\n      // Default dialog action\n      var dialogAction = {\n        type: 'Delegate',\n        slots: originalSlots\n      };\n      // If the response doesn't contain an override replay the inputs\n      if (responseDialogAction) {\n        // We bypassed dialoghook so delegate and pass through inputs\n        dialogAction = responseDialogAction;\n      }\n        intentResponse = {\n            sessionAttributes: sessionAttributes,\n            dialogAction: dialogAction\n        };\n    } else {\n      // Override required session attributes\n      sessionAttributes.statusCode = statusCode;\n      sessionAttributes.message = message;\n      // Build response template\n      intentResponse = {\n        sessionAttributes: sessionAttributes,\n        dialogAction: {\n          type: 'Close',\n          fulfillmentState: 'Fulfilled',\n          message: {\n            contentType: 'PlainText',\n            content: message\n          }\n        }\n      };\n  }\n  httpResponse.setBody(intentResponse);\n})(ctx, operationRequest, operationResponse, httpResponse);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Object",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "A map of key-value pairs that were previously set on the CTIOperationResponse\n                object. This key-value pairs are free-form and defined by the needs of the operation\n                handler. The returned values are either Strings or Numbers.",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getParameters",
        "hasExample": true,
        "hasReturn": true,
        "name": "getParameters()",
        "order": 8590,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the key-value pairs for all parameters that were previously set on the current\n    CTIOperationResponse object.",
        "text2": "<p>Using the get/set parameter methods enables the passing of\n        virtually any string or number value between an operation handler and a message transformer.\n        The parameter object can contain zero or more key/value pairs of data that directly\n        correlate to the current operation response. The operation handler determines what key/value\n        pairs are required as it produces these values. Use the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setParameter_S_O&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setParameter(String key, Object value)</a>\n         method to set parameters on the\n        current CTIOperationResponse object.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nvar phoneAttribute = response.getSessionAttribute('contact.phone');</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Value of the passed in key. If no such key exists, returns null.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The name of the key value to return.",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getSessionAttribute_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "getSessionAttribute(String key)",
        "order": 9330,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the value for a specified session attribute key set on the current\n    CTIOperationResponse object.",
        "text2": "<p>Using the get/set session attribute methods enables the\n        passing of virtually any string or number value between an operation handler and a message\n        transformer. Session attributes can also be accessed within a contact flow. The\n        sessionAttribute object can contain zero or more key/value pairs of data, such as the\n        contact's phone number, that are valid for the duration of a computer telephony integration\n        provider defined session. The operation handler determines what session attribute key/value\n        pairs are needed as it utilizes these values during processing. Typically the operation\n        handler sets these attributes on the CTIOperationResponse object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setSessionAttribute_S_O&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setSessionAttribute(String key, Object value)</a>\n        method and the message transformer consumes the attributes using this method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Object",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "A map of key-value pairs that were previously set on the CTIOperationResponse\n                object. This key-value pairs are free-form and defined by the needs of the operation\n                handler. The returned values are either Strings or Numbers.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function (/*CTIOperationResponse*/operationResponse, /*HTTPResponse*/ httpResponse) {\n  // AWS Connect Lambda expects name value pairs only\n  var out = {};\n  for(var k in operationResponse.getSessionAttributes()) {\n    out[k] = operationResponse.getSessionAttributes()[k];\n  }\n  out.statusCode = operationResponse.getStatusCode();\n  out.message = operationResponse.getMessage();\n  httpResponse.setBody(out);\n})(operationResponse, httpResponse);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-getSessionAttributes",
        "hasExample": true,
        "hasReturn": true,
        "name": "getSessionAttributes()",
        "order": 9350,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the key-value pairs for all session attributes that were previously set on the\n    current CTIOperationResponse object.",
        "text2": "<p>Using the get/set session attribute methods enables the\n        passing of virtually any string or number value between an operation handler and a message\n        transformer. Session attributes can also be accessed within a contact flow. The\n        sessionAttribute object can contain zero or more key/value pairs of data, such as the\n        contact's phone number, that are valid for the duration of a computer telephony integration\n        provider defined session. The operation handler determines what session attribute key/value\n        pairs are needed as it utilizes these values during processing. Typically the operation\n        handler sets these attributes on the CTIOperationResponse object by calling the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setSessionAttribute_S_O&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setSessionAttribute(String key, Object value)</a>\n        method and the message transformer consumes the attributes using this method.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Number",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Status code of the current operation. If a status code has not been set,\n                returns -1.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function (/*CTIOperationResponse*/operationResponse, /*HTTPResponse*/ httpResponse) {\n  // AWS Connect Lambda expects name value pairs only\n  var out = {};\n  for(var k in operationResponse.getSessionAttributes()) {\n    out[k] = operationResponse.getSessionAttributes()[k];\n  }\n  out.statusCode = operationResponse.getStatusCode();\n  out.message = operationResponse.getMessage();\n  httpResponse.setBody(out);\n})(operationResponse, httpResponse);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOPResp-getStatusCode",
        "hasExample": true,
        "hasReturn": true,
        "name": "getStatusCode()",
        "order": 9530,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Returns the status code set on the current CTIOperationResponse object.",
        "text2": "<p>These status codes should correspond with standard HTTP status codes, such as 200 for\n        success, 401 for authorization required. Typically, the resultant status codes are\n        determined by the operation handler and are set on the CTIOperationResponse object using the\n          <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-setStatusCode_N&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          setStatusCode(String statusCode)</a> method. The message transformer then uses this method to\n        include the status code in the payload returned to the computer telephony integrator\n        provider.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "String",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "The authentication token to use to authenticate operations that have the\n                  <span class=\"keyword parmname\">auth_required</span> flag set.",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nvar authenticate = &lt;Your authentication code here&gt;; // Authenticate the user\nif (authenticated) {\n\tvar claims = {\n\t\t\"interactionId\":interactionGr.sys_id.toString()\n\t};\n\tvar jwt = new sn_cti_core.AuthHelpers().generateJWT(claims);\n\tresponse.setAuthToken(jwt);\n}</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setAuthToken_S",
        "hasExample": true,
        "hasReturn": true,
        "name": "setAuthToken(String token)",
        "order": 12700,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets an authentication token on the current CTIOperationResponse object.",
        "text2": "<p>This token is used by the Cloud Call Center framework to authenticate the current Cloud\n        Call Center user before executing the requested operation handler if the handler's\n          <span class=\"keyword parmname\">auth_required</span> flag is set to true. The\n          <span class=\"keyword parmname\">auth_required</span> flag is a field in the Operation Handler\n        [sn_cti_operation_handler] table. The life of an authentication token should be for the life\n        of the call session, but is determined by the CTI provider.</p><p>You can define whatever authentication/authorization handling required by your\n        implementation by creating your own authentication operation handler. Regardless of how the\n        authentication token is generated, the message translator must pass the token back in the\n        CTI payload. Additionally, the CTI provider must store this authentication token locally and\n        pass it in each operation request that requires authentication.</p><p>If using the instance provided authenticate operation handler, the handler initiates the\n        creation of the authentication token based on a four-digit user-entered pin. It then sets\n        the authentication token in the sessionAttributes object of the CTIOperationResponse object.\n        The associated message transformer translates the sessionAttributes object into the\n        CTI-specific payload and then sends it to the CTI provider.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> If the authentication token is not passed, all requests to execute operation handlers\n          with the <span class=\"keyword parmname\">auth_required</span> flag set will fail. If you do not use\n          authentication, you do not need to maintain authentication tokens.</div></p><p>The <span class=\"ph\">ServiceNow</span> base system provides\n        working operation handlers and message transformers that enable connection to Amazon\n        Connect. When building contact flows within Amazon Connect, there are two integration points\n        between Amazon services and a <span class=\"ph\">ServiceNow</span> instance:<ul class=\"ul\" id=\"CTIOpResp-setAuthToken_S__d413e90\">\n          <li class=\"li\">Amazon Web Services (AWS) Lambda Proxy (Invoke AWS Lambda function)</li>\n\n          <li class=\"li\">AWS Lex Bot (Get Customer Input) </li>\n\n        </ul>\nYou can find the available operation handlers and message transformers for these\n        integration points in the Operation Handlers [sn_cti_operation_handler] and Provider Message\n        Transformer [sn_cti_provider_msg_transormer] tables.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "error",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Object",
            "text2": "Information about the error that was detected while processing the requested\n                operation. The format of this object is determined by the CTI provider.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nresponse.setError(new Error(You did not supply a field));</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setError_O",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setError(Object error)",
        "order": 13160,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the error object in the current CTIOperationResponse object.",
        "text2": "<p>You can use the error object in the component to formulate the payload to send to the\n        computer telephony integrator (CTI) provider.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nresponse.setInteractionSysId('98529cc55380001048e5ddeeff7b120b');\n</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "sys_id",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "The sys_id to set for the current interaction.",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setInteractionSysId_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setInteractionSysId(String Id)",
        "order": 13410,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the sys_id of the interaction record associated with the operation request on the\n    current CTIOperationResponse object.",
        "text2": null,
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var request = new sn_cti_core.CTIOperationResponse();\nrequest.setMajorVersion(2);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "majorVersion",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Number",
            "text2": "Major version of the CTI provider software making the operation request.<p class=\"p\">If\n                  this value was not previously set, returns\n                <samp class=\"ph systemoutput\">1</samp>.</p>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setMajorVersion_N",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setMajorVersion(Number majorVersion)",
        "order": 13530,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the major version of the computer telephony integrator (CTI) provider software\n    making the request on the associated CTIOperationResponse object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span>\n        instance are running multiple versions of their software, as different software versions may\n        require different payloads. If the payload is only slightly different between the software\n        versions, it may make sense to have only a single message transformer. You can then handle\n        the payload differences by just checking the version of software making the request within\n        your message transformer. If the required payload is significantly different between\n        versions, it may be more effective to use multiple message transformers.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "message",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "Message text",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function(/*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response, /*Context*/ ctx) {\t\n  var notes = '', lang = request.getLanguage();\n  try { \n\t\t\n    var interactionGr = request.getInteractionRecord();\n\n    var now_GR = new GlideRecord('sys_user');\n    if(interactionGr &amp;&amp; now_GR.get(interactionGr.opened_for.toString())) {\t\n      if(now_GR.locked_out == true) {\n        notes += gs.getMessageLang(\"User record found locked. Unlocking the account.\\n\", lang);\n        now_GR.locked_out=false;\n        now_GR.update();\n        response.setStatusCode(200);\n        response.setMessage(gs.getMessageLang(\"Your account has been unlocked.\", lang));\n      } else {\n        notes += gs.getMessageLang(\"User record not locked.\\n\", lang);\n        response.setStatusCode(200);\n        response.setMessage(gs.getMessageLang(\"Your account doesn't seem to be locked.\", lang));\n      }\t\n    } else {\n      notes += gs.getMessageLang(\"User record not found. Transfer to agent\\n\", lang);\n      response.setStatusCode(302);\n      response.setMessage(gs.getMessageLang(\"I am unable to find your record. Let me transfer to someone who can help.\", lang));\n    }\n    if(interactionGr) {\n      interactionGr.work_notes = notes;\n      interactionGr.update();\n    }\n  } catch(e) {\n    ctx.setError(e);\n  }\n})(request, response, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setMessage_S",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setMessage(String message)",
        "order": 13590,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets a text message on the current CTIOperationResponse object.",
        "text2": "<p>Typically this is a message that is spoken back to the user once an operation is complete\n        and is set by the associated operation handler. The message transformer then uses the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-getMessage&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          getMessage()</a> method to obtain the message\n        and pass it back to the computer telephony integration provider.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nresponse.setMinorVersion(3);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "minorVersion",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Number",
            "text2": "Minor version of the CTI provider software making the operation request.<p class=\"p\">If\n                  this value was not previously set, returns\n                <samp class=\"ph systemoutput\">0</samp>.</p>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setMinorVersion_N",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setMinorVersion(Number minorVersion)",
        "order": 13640,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the minor version of the computer telephony integrator (CTI) provider software\n    making the request on the associated CTIOperationResponse object.",
        "text2": "<p>Use this method if the CTI providers connected to your <span class=\"ph\">ServiceNow</span>\n        instance are running multiple versions of their software, as different software versions may\n        require different payloads. If the payload is only slightly different between the software\n        versions, it may make sense to have only a single message transformer. You can then handle\n        the payload differences by just checking the version of software making the request within\n        your message transformer. If the required payload is significantly different between\n        versions, it may be more effective to use multiple message transformers.</p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nresponse.setParameter('contact.phone', '+15552222345');\nresponse.setParameter('contact.okToCall', true);\nresponse.setParameter('contact.address', {\n    street: '1234 Main St'\n    city: 'API City',\n    zip: 91335\n});</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "Name of the key under which to store the associated value.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "value",
            "order": 20,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Object",
            "text2": "Value to store for the key.<div class=\"p\">Valid data types:<ul class=\"ul\" id=\"CTIOpResp-setParameter_S_O__ul_mcs_2sr_zkb\">\n                    <li class=\"li\">string</li>\n\n                    <li class=\"li\">int</li>\n\n                    <li class=\"li\">float</li>\n\n                    <li class=\"li\">number</li>\n\n                    <li class=\"li\">boolean</li>\n\n                    <li class=\"li\">date</li>\n\n                    <li class=\"li\">object</li>\n\n                  </ul>\n</div>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setParameter_S_O",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setParameter(String key, Object value)",
        "order": 13810,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the specified key-value pair on the associated CTIOperationResponse\n    object.",
        "text2": "<p>Using the get/set parameter methods enables the passing of virtually any string or number\n        value between an operation handler and a message transformer. The parameter object can\n        contain zero or more key/value pairs of data that directly correlate to the current\n        operation request. The operation handler determines what key/value pairs are required as it\n        consumes these values. Typically the operation handler sets these parameters on the\n        CTIOperationResponse object by calling this method and the message transformer consumes them\n        using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-getParameter_S&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          getParmeter(String key)</a> or <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-getParameters&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          getSParameters()</a> method.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> You should only store objects that can survive a\n            <code class=\"ph codeph\">JSON.parse(JSON.stringify(object))</code> operation. Objects not meeting this\n          criteria may not propagate correctly through the entire operation processing chain.</div></p><p>For\n        example:<pre class=\"pre codeblock\"><code>var x = {\n  \"string\": 'abc',\n  \"int\": 123,\n  \"float\": 1.234,\n  \"number\": new Number(3),\n  \"boolean\": true,\n  \"date\": new Date(2006, 0, 2, 15, 4, 5),\n  \"object\": {\n    \"string\": 'abc',\n    \"int\": 123,\n    \"float\": 1.234,\n    \"number\": new Number(3),\n    \"boolean\": true,\n    \"date\": new Date(2006, 0, 2, 15, 4, 5)\n  },\n  \"function\": function(abc) {\n\n  }\n}\nvar stringify = JSON.stringify(x);\ngs.info(stringify);\nvar hydrate = JSON.parse(stringify);\nvar stringify2 = JSON.stringify(hydrate);\ngs.info(stringify2);\n</code></pre></p><p>Produces:<pre class=\"pre codeblock\"><code>{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n</code></pre></p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "key",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "String",
            "text2": "Name of the session attribute key under which to set the associated\n                value.",
            "type": "Parameter",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>var response = new sn_cti_core.CTIOperationResponse();\nresponse.setSessionAttribute('contact.phone', '+15552222345');\nresponse.setSessionAttribute('contact.okToCall', true);\nresponse.setSessionAttribute('contact.address', {\n    street: '1234 Main St'\n    city: 'API City',\n    zip: 91335\n});</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "value",
            "order": 20,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Object",
            "text2": "Value to set.<div class=\"p\">Valid data types:<ul class=\"ul\" id=\"CTIOpResp-setSessionAttribute_S_O__ul_mcs_2sr_zkb\">\n                    <li class=\"li\">string</li>\n\n                    <li class=\"li\">int</li>\n\n                    <li class=\"li\">float</li>\n\n                    <li class=\"li\">number</li>\n\n                    <li class=\"li\">boolean</li>\n\n                    <li class=\"li\">date</li>\n\n                    <li class=\"li\">object</li>\n\n                  </ul>\n</div>",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setSessionAttribute_S_O",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setSessionAttribute(String key, Object value)",
        "order": 14080,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the specified session attribute key-value pair on the associated\n    CTIOperationResponse object.",
        "text2": "<p>Using the get/set session attribute methods enables the passing of virtually any string or\n        number value between an operation handler and a message transformer. The sessionAttribute\n        object can contain zero or more key/value pairs of data that are valid for the duration of a\n        computer telephony integration provider defined session. Session attributes can also be\n        accessed within a contact flow. The operation handler determines what session attribute\n        key/value pairs are needed as it consumes these values. Typically the operation handler sets\n        these attributes on the CTIOperationResponse object by calling this method and the message\n        transformer gets the attributes using the <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-getSessionAttribute_S&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          getSessionAttribute(String key)</a> or <a class=\"xref\" href=\"https://developer.servicenow.com/go_to_api.do?ID=CTIOpResp-getSessionAttributes&amp;v=paris\" target=\"_blank\">CTIOperationResponse -\n          getSessionAttribute()</a> method.</p><p><div class=\"note note\"><span class=\"notetitle\">Note:</span> You should only store objects that can survive a\n            <code class=\"ph codeph\">JSON.parse(JSON.stringify(object))</code> operation. Objects not meeting this\n          criteria may not propagate correctly through the entire operation processing chain.</div></p><p>For\n        example:<pre class=\"pre codeblock\"><code>var x = {\n  \"string\": 'abc',\n  \"int\": 123,\n  \"float\": 1.234,\n  \"number\": new Number(3),\n  \"boolean\": true,\n  \"date\": new Date(2006, 0, 2, 15, 4, 5),\n  \"object\": {\n    \"string\": 'abc',\n    \"int\": 123,\n    \"float\": 1.234,\n    \"number\": new Number(3),\n    \"boolean\": true,\n    \"date\": new Date(2006, 0, 2, 15, 4, 5)\n  },\n  \"function\": function(abc) {\n\n  }\n}\nvar stringify = JSON.stringify(x);\ngs.info(stringify);\nvar hydrate = JSON.parse(stringify);\nvar stringify2 = JSON.stringify(hydrate);\ngs.info(stringify2);\n</code></pre></p><p>Produces:<pre class=\"pre codeblock\"><code>{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\",\"object\":{\"string\":\"abc\",\"int\":123,\"float\":1.234,\"number\":3,\"boolean\":true,\"date\":\"2006-01-02T23:04:05.000Z\"}}\n</code></pre></p>",
        "type": "Method",
        "variable": null
      },
      {
        "children": [
          {
            "children": null,
            "dc_identifier": null,
            "name": "Example",
            "order": 10,
            "release": "paris",
            "sectionHeader": null,
            "sectionTitle": null,
            "tableHeader": null,
            "text": "<code>(function(/*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response, /*Context*/ ctx) {\t\n  var notes = '', lang = request.getLanguage();\n  try { \n\t\t\n    var interactionGr = request.getInteractionRecord();\n\n    var now_GR = new GlideRecord('sys_user');\n    if(interactionGr &amp;&amp; now_GR.get(interactionGr.opened_for.toString())) {\t\n      if(now_GR.locked_out == true) {\n        notes += gs.getMessageLang(\"User record found locked. Unlocking the account.\\n\", lang);\n        now_GR.locked_out=false;\n        now_GR.update();\n        response.setStatusCode(200);\n        response.setMessage(gs.getMessageLang(\"Your account has been unlocked.\", lang));\n      } else {\n        notes += gs.getMessageLang(\"User record not locked.\\n\", lang);\n        response.setStatusCode(200);\n        response.setMessage(gs.getMessageLang(\"Your account doesn't seem to be locked.\", lang));\n      }\t\n    } else {\n      notes += gs.getMessageLang(\"User record not found. Transfer to agent\\n\", lang);\n      response.setStatusCode(302);\n      response.setMessage(gs.getMessageLang(\"I am unable to find your record. Let me transfer to someone who can help.\", lang));\n    }\n    if(interactionGr) {\n      interactionGr.work_notes = notes;\n      interactionGr.update();\n    }\n  } catch(e) {\n    ctx.setError(e);\n  }\n})(request, response, ctx);</code>",
            "text2": null,
            "type": "Example",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "void",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Returns",
            "sectionTitle": null,
            "tableHeader": "Type,Description",
            "text": "Method does not return a value",
            "text2": null,
            "type": "Return",
            "variable": null
          },
          {
            "children": null,
            "dc_identifier": null,
            "name": "statusCode",
            "order": 10,
            "release": "paris",
            "sectionHeader": "Parameters",
            "sectionTitle": null,
            "tableHeader": "Name,Type,Description",
            "text": "Number",
            "text2": "Integer that uniquely identifies the status of the requested operation.",
            "type": "Parameter",
            "variable": null
          }
        ],
        "dc_identifier": "CTIOpResp-setStatusCode_N",
        "hasExample": true,
        "hasParameter": true,
        "hasReturn": true,
        "name": "setStatusCode(Number statusCode)",
        "order": 14170,
        "parentId": "CTIOperationResponseAPI",
        "parent_permalink": "class_namespace__scoped_ctioperationresponse___scoped__global_sn_cti_core__paris",
        "release": "paris",
        "sectionHeader": null,
        "sectionTitle": null,
        "tableHeader": null,
        "text": "Sets the status code of the current operation request on the CTIOperationResponse\n    object.",
        "text2": "<p>You can use any integer values to define the status, but it is recommended that you emulate\n        the HTTP status codes, such as 200 = Ok/Success, 400 = Bad Request, 401 = Unauthorized.</p>",
        "type": "Method",
        "variable": null
      }
    ],
    "dc_identifier": "CTIOperationResponseAPI",
    "is_current": true,
    "is_highlighted": true,
    "level": "Class",
    "name": "CTIOperationResponse - Scoped, Global",
    "namespace_id": "sn_cti_core-namespace",
    "release": "paris",
    "text": "The <span class=\"keyword apiname\">CTIOperationResponse</span> API provides methods to set and get data on\n    the current CTIOperationResponse object.",
    "text2": "You use CTIOperationResponse objects to pass information between an operation handler and a\n      message transformer within the Cloud Call Center framework.<br/><br/>Typically, an operation handler is responsible for setting values on the CTIOperationResponse\n      object as it processes the associated request. A message transformer is then responsible for\n      getting the values from the CTIOperationRequest object and building the CTI-specific payload\n      that is sent back to the computer telephony integrator (CTI) provider.<br/><br/>The <span class=\"ph\">ServiceNow</span> base system provides\n        working operation handlers and message transformers that enable connection to Amazon\n        Connect. When building contact flows within Amazon Connect, there are two integration points\n        between Amazon services and a <span class=\"ph\">ServiceNow</span> instance:<ul class=\"ul\" id=\"CTIOperationResponseAPI__d4279e90\">\n          <li class=\"li\">Amazon Web Services (AWS) Lambda Proxy (Invoke AWS Lambda function)</li>\n\n          <li class=\"li\">AWS Lex Bot (Get Customer Input) </li>\n\n        </ul>\nYou can find the available operation handlers and message transformers for these\n        integration points in the Operation Handlers [sn_cti_operation_handler] and Provider Message\n        Transformer [sn_cti_provider_msg_transormer] tables.<br/><br/>The following operation handler script shows how to use various\n        <span class=\"keyword apiname\">CTIOperationResponse</span> methods to set values on the CTIOperationResponse\n      object.<br/><br/><pre><code class='language-javascript'><code>(function(/*CTIOperationRequest*/ request, /*CTIOperationResponse*/ response) {\n\n  try {\n    var state = request.getParameter('$state');\n    if(!state) {\n      state = 'new';\n    }\n    var phone = request.getParameter('contact.phone');\n    var username = request.getParameter('contact.username');\n    var someDataPresent = phone || username;\n    if(!someDataPresent) {\n      throw 'phone or username must be supplied';\n    }\n    if('new' === state) {\n      var userGr = null;\n      if(phone || username) {\n        userGr = new GlideRecordSecure('sys_user');\n        var qc = null;\n        if(phone) {\n          qc = userGr.addQuery('phone', phone);\n          qc.addOrCondition('mobile_phone', phone);\n          qc.addOrCondition(\"home_phone\", phone);\n        }\n        if(username) {\n          if(qc) {\n            qc.addOrCondition('user_name', username);\n          } else {\n            qc = userGr.addQuery('user_name', username);\n          }\n        }\n        // If there was criteria then run the query\n        if(qc) {\n          userGr.query();\n        } else {\n          userGr = null;\n        }\n      }\n\t\t\t\n      var foundUser = userGr &amp;&amp; userGr.next();\n\n      var phonelogGr = new GlideRecord('sn_openframe_phone_log');\n      phonelogGr.initialize();\n      phonelogGr.setValue('call_id', request.getParameter('contact.id'));\n      phonelogGr.setValue('phone_number', phone);\n      if(foundUser) {\n        phonelogGr.setValue('contact', userGr.getUniqueValue());\n      }\n      phonelogGr.insert();\n\t\t\t\n      var interactionGr = new GlideRecordSecure('interaction');\n      interactionGr.initialize();\n      interactionGr.setValue('type', 'phone');\n      interactionGrsetValue('short_description', 'User Contact via Phone: ' + phone);\n      interactionGr.setValue('channel_metadata_table', 'sn_openframe_phone_log');\n      interactionGr.setValue('channel_metadata_document',phonelogGr.getUniqueValue());\n\t\t\t\n      if(foundUser) {\n        interactionGr.setValue('opened_for', userGr.getUniqueValue());\n        response.setSessionAttribute('snc_user_first_name', userGr.getValue('first_name'));\n        response.setSessionAttribute('snc_user_last_name', userGr.getValue('last_name'));\n        response.setSessionAttribute('snc_user_sys_id', userGr.getUniqueValue());\n      } else {\n        response.setSessionAttribute('snc_user_sys_id', \"USER_NOT_FOUND\");\n      }\n      interactionGr.setValue('state', 'new');\n\n      var interactionId = interactionGr.insert();\n\n      response.setStatusCode(200);\n      response.setMessage('success');\n      response.setSessionAttribute('interactionTable', 'interaction');\n      response.setSessionAttribute('interactionId', interactionId);\n\n    }\n  } catch(e) {\n    ctx.setError(e);\n  }\n\n})(request, response);</code></code></pre><br/><br/>For additional information on creating operation handlers, see <a class=\"xref\" href=\"https://docs.servicenow.com/bundle/paris-servicenow-platform/page/product/cloud-call-center/task/establish-automated-bot-interactions.html\" target=\"_blank\">Configure a contact flow for an\n        automated caller interaction</a>.<br/><br/>The following message transformer script gets the values set on the CTIOperationResponse\n      object and stores them in the CTI-specific payload that is then sent back to the CTI\n      provider.<br/><br/><pre><code class='language-javascript'><code>(function (/*CTIOperationResponse*/operationResponse, /*HTTPResponse*/ httpResponse) {\n\t// AWS Connect Lambda expects name value pairs only\n\tvar out = {};\n\tfor(var k in operationResponse.getSessionAttributes()) {\n\t\tout[k] = operationResponse.getSessionAttributes()[k];\n\t}\n\tout.statusCode = operationResponse.getStatusCode();\n\tout.message = operationResponse.getMessage();\n\thttpResponse.setBody(out);\n})(operationResponse, httpResponse);</code></code></pre><br/><br/>This API runs in the <span class=\"keyword parmname\">sn_cti_core</span> namespace. Before you are able to\n      access the <span class=\"keyword apiname\">CTIOperationRequest</span> API, the Cloud Call Center Core\n      (sn_cti_core) application must be installed. For information on this installation, see <a class=\"xref\" href=\"https://docs.servicenow.com/bundle/paris-servicenow-platform/page/product/cloud-call-center/task/install-ccc-apps.html\" target=\"_blank\">Install Cloud Call Center\n        applications</a>.<br/><br/>For additional information on the Cloud Call Center, see <a class=\"xref\" href=\"https://docs.servicenow.com/bundle/paris-servicenow-platform/page/product/cloud-call-center/concept/cloud-call-center-overview.html\" target=\"_blank\">Cloud Call Center</a>.",
    "type": "Server Side Scoped",
    "variable": ""
  }
]